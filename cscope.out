cscope 15 $HOME\Desktop\INTEL\src\Webserver"               0000082895
	@App/App.cpp

26 
	~<¡dio.h
>

27 
	~<¡ršg.h
>

28 
	~<as£¹.h
>

30 #ifdeà
_MSC_VER


31 
	~<Shlobj.h
>

33 
	~<uni¡d.h
>

34 
	~<pwd.h
>

35 
	#MAX_PATH
 
FILENAME_MAX


	)

38 
	~"sgx_u¹s.h
"

39 
	~"sgx_u«_£rviû.h
"

40 
	~"Aµ.h
"

41 
	~"Enşave_u.h
"

44 
sgx_’şave_id_t
 
	gglob®_eid
 = 0;

46 
	s_sgx_”¾i¡_t
 {

47 
sgx_¡©us_t
 
	m”r
;

48 cÚ¡ *
	mmsg
;

49 cÚ¡ *
	msug
;

50 } 
	tsgx_”¾i¡_t
;

53 
sgx_”¾i¡_t
 
	gsgx_”¾i¡
[] = {

55 
SGX_ERROR_UNEXPECTED
,

57 
NULL


60 
SGX_ERROR_INVALID_PARAMETER
,

62 
NULL


65 
SGX_ERROR_OUT_OF_MEMORY
,

67 
NULL


70 
SGX_ERROR_ENCLAVE_LOST
,

75 
SGX_ERROR_INVALID_ENCLAVE
,

77 
NULL


80 
SGX_ERROR_INVALID_ENCLAVE_ID
,

82 
NULL


85 
SGX_ERROR_INVALID_SIGNATURE
,

87 
NULL


90 
SGX_ERROR_OUT_OF_EPC
,

92 
NULL


95 
SGX_ERROR_NO_DEVICE
,

100 
SGX_ERROR_MEMORY_MAP_CONFLICT
,

102 
NULL


105 
SGX_ERROR_INVALID_METADATA
,

107 
NULL


110 
SGX_ERROR_DEVICE_BUSY
,

112 
NULL


115 
SGX_ERROR_INVALID_VERSION
,

117 
NULL


120 
SGX_ERROR_INVALID_ATTRIBUTE
,

122 
NULL


125 
SGX_ERROR_ENCLAVE_FILE_ACCESS
,

127 
NULL


130 
SGX_ERROR_NDEBUG_ENCLAVE
,

132 
NULL


137 
	$´št_”rÜ_mes§ge
(
sgx_¡©us_t
 
»t
)

139 
size_t
 
idx
 = 0;

140 
size_t
 
‰l
 =  
sgx_”¾i¡
/ sgx_errlist[0];

142 
idx
 = 0; idx < 
‰l
; idx++) {

143 if(
»t
 =ğ
sgx_”¾i¡
[
idx
].
”r
) {

144 if(
NULL
 !ğ
sgx_”¾i¡
[
idx
].
sug
)

145 
	`´štf
("Info: %s\n", 
sgx_”¾i¡
[
idx
].
sug
);

146 
	`´štf
("E¼Ü: %s\n", 
sgx_”¾i¡
[
idx
].
msg
);

151 ià(
idx
 =ğ
‰l
)

152 
	`´štf
("Error: Unexpectedƒrror occurred.\n");

153 
	}
}

160 
	$š™Ÿlize_’şave
()

162 
tok’_·th
[
MAX_PATH
] = {'\0'};

163 
sgx_Ïunch_tok’_t
 
tok’
 = {0};

164 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

165 
upd©ed
 = 0;

170 #ifdeà
_MSC_VER


172 ià(
S_OK
 !ğ
	`SHG‘FŞd”P©hA
(
NULL
, 
CSIDL_LOCAL_APPDATA
, NULL, 0, 
tok’_·th
)) {

173 
	`¡ºıy_s
(
tok’_·th
, 
	`_couÁof
Ñok’_·th), 
TOKEN_FILENAME
, (TOKEN_FILENAME));

175 
	`¡ºÿt_s
(
tok’_·th
, 
	`_couÁof
Ñok’_·th), "\\" 
TOKEN_FILENAME
, (TOKEN_FILENAME)+2);

179 
HANDLE
 
tok’_hªdËr
 = 
	`C»©eFeA
(
tok’_·th
, 
GENERIC_READ
|
GENERIC_WRITE
, 
FILE_SHARE_READ
, 
NULL
, 
OPEN_ALWAYS
, NULL, NULL);

180 ià(
tok’_hªdËr
 =ğ
INVALID_HANDLE_VALUE
) {

181 
	`´štf
("W¬nšg: FaedØü—‹/İ’hÏunchok’ f\"%s\".\n", 
tok’_·th
);

184 
DWORD
 
»ad_num
 = 0;

185 
	`R—dFe
(
tok’_hªdËr
, 
tok’
, (
sgx_Ïunch_tok’_t
), &
»ad_num
, 
NULL
);

186 ià(
»ad_num
 !ğ0 &&„—d_num !ğ(
sgx_Ïunch_tok’_t
)) {

188 
	`mem£t
(&
tok’
, 0x0, (
sgx_Ïunch_tok’_t
));

189 
	`´štf
("W¬nšg: Inv®id†aunchok’„—d from \"%s\".\n", 
tok’_·th
);

194 cÚ¡ *
home_dœ
 = 
	`g‘pwuid
(
	`g‘uid
())->
pw_dœ
;

196 ià(
home_dœ
 !ğ
NULL
 &&

197 (
	`¡¾’
(
home_dœ
)+¡¾’("/")+(
TOKEN_FILENAME
)+1è<ğ
MAX_PATH
) {

199 
	`¡ºıy
(
tok’_·th
, 
home_dœ
, 
	`¡¾’
(home_dir));

200 
	`¡ºÿt
(
tok’_·th
, "/", 
	`¡¾’
("/"));

201 
	`¡ºÿt
(
tok’_·th
, 
TOKEN_FILENAME
, (TOKEN_FILENAME)+1);

204 
	`¡ºıy
(
tok’_·th
, 
TOKEN_FILENAME
, (TOKEN_FILENAME));

207 
FILE
 *
å
 = 
	`fİ’
(
tok’_·th
, "rb");

208 ià(
å
 =ğ
NULL
 && (å = 
	`fİ’
(
tok’_·th
, "wb")) == NULL) {

209 
	`´štf
("W¬nšg: FaedØü—‹/İ’hÏunchok’ f\"%s\".\n", 
tok’_·th
);

212 ià(
å
 !ğ
NULL
) {

214 
size_t
 
»ad_num
 = 
	`ä—d
(
tok’
, 1, (
sgx_Ïunch_tok’_t
), 
å
);

215 ià(
»ad_num
 !ğ0 &&„—d_num !ğ(
sgx_Ïunch_tok’_t
)) {

217 
	`mem£t
(&
tok’
, 0x0, (
sgx_Ïunch_tok’_t
));

218 
	`´štf
("W¬nšg: Inv®id†aunchok’„—d from \"%s\".\n", 
tok’_·th
);

224 
»t
 = 
	`sgx_ü—‹_’şave
(
ENCLAVE_FILENAME
, 
SGX_DEBUG_FLAG
, &
tok’
, &
upd©ed
, &
glob®_eid
, 
NULL
);

225 ià(
»t
 !ğ
SGX_SUCCESS
) {

226 
	`´št_”rÜ_mes§ge
(
»t
);

227 #ifdeà
_MSC_VER


228 ià(
tok’_hªdËr
 !ğ
INVALID_HANDLE_VALUE
)

229 
	`Clo£HªdË
(
tok’_hªdËr
);

231 ià(
å
 !ğ
NULL
è
	`fşo£
(fp);

237 #ifdeà
_MSC_VER


238 ià(
upd©ed
 =ğ
FALSE
 || 
tok’_hªdËr
 =ğ
INVALID_HANDLE_VALUE
) {

240 ià(
tok’_hªdËr
 !ğ
INVALID_HANDLE_VALUE
)

241 
	`Clo£HªdË
(
tok’_hªdËr
);

246 
	`FlushFeBufãrs
(
tok’_hªdËr
);

248 
	`S‘FePoš‹r
(
tok’_hªdËr
, 0, 
NULL
, 
FILE_BEGIN
);

251 
DWORD
 
wr™e_num
 = 0;

252 
	`Wr™eFe
(
tok’_hªdËr
, 
tok’
, (
sgx_Ïunch_tok’_t
), &
wr™e_num
, 
NULL
);

253 ià(
wr™e_num
 !ğ(
sgx_Ïunch_tok’_t
))

254 
	`´štf
("W¬nšg: FaedØ§vÏunchok’Ø\"%s\".\n", 
tok’_·th
);

255 
	`Clo£HªdË
(
tok’_hªdËr
);

257 ià(
upd©ed
 =ğ
FALSE
 || 
å
 =ğ
NULL
) {

259 ià(
å
 !ğ
NULL
è
	`fşo£
(fp);

264 
å
 = 
	`äeİ’
(
tok’_·th
, "wb", fp);

265 ià(
å
 =ğ
NULL
)  0;

266 
size_t
 
wr™e_num
 = 
	`fwr™e
(
tok’
, 1, (
sgx_Ïunch_tok’_t
), 
å
);

267 ià(
wr™e_num
 !ğ(
sgx_Ïunch_tok’_t
))

268 
	`´štf
("W¬nšg: FaedØ§vÏunchok’Ø\"%s\".\n", 
tok’_·th
);

269 
	`fşo£
(
å
);

272 
	}
}

275 
	$oÿÎ_´št_¡ršg
(cÚ¡ *
¡r
)

280 
	`´štf
("%s", 
¡r
);

281 
	}
}

283 "C" 
LaunchAµ
(*);

285 
	$oÿÎ_g’”ic
(
±r
)

287 ià(
±r
 == 1)

289 
	`´štf
("±r:%Îx\n", 
±r
);

292 
	`´štf
("±r:%Îx\n", 
±r
);

294 
	}
}

296 #ià
defšed
(
_MSC_VER
)

298 
	$qu”y_sgx_¡©us
()

300 
sgx_deviû_¡©us_t
 
sgx_deviû_¡©us
;

301 
sgx_¡©us_t
 
sgx_»t
 = 
	`sgx_’abË_deviû
(&
sgx_deviû_¡©us
);

302 ià(
sgx_»t
 !ğ
SGX_SUCCESS
) {

303 
	`´štf
("Failedo get SGX device status.\n");

307 
sgx_deviû_¡©us
) {

308 
SGX_ENABLED
:

310 
SGX_DISABLED_REBOOT_REQUIRED
:

311 
	`´štf
("SGX device has beenƒnabled. Please„eboot your machine.\n");

313 
SGX_DISABLED_LEGACY_OS
:

314 
	`´štf
("SGX device can't beƒnabled on‡n OShat doesn't support EFI interface.\n");

316 
SGX_DISABLED
:

317 
	`´štf
("SGX is‚otƒnabled onhis…latform. More details‡re unavailable.\n");

319 
SGX_DISABLED_SCI_AVAILABLE
:

320 
	`´štf
("SGX device can beƒnabled by‡ Software Control Interface.\n");

322 
SGX_DISABLED_MANUAL_ENABLE
:

323 
	`´štf
("SGX device can beƒnabled manually inhe BIOS setup.\n");

325 
SGX_DISABLED_HYPERV_ENABLED
:

326 
	`´štf
("Detected‡n unsupported version of Windows* 10 with Hyper-Vƒnabled.\n");

328 
SGX_DISABLED_UNSUPPORTED_CPU
:

329 
	`´štf
("SGX is‚ot supported byhis CPU.\n");

332 
	`´štf
("Unexpectedƒrror.\n");

336 
	}
}

340 
SGX_CDECL
 
	$maš
(
¬gc
, *
¬gv
[])

342 ()(
¬gc
);

343 ()(
¬gv
);

346 #ià
	`defšed
(
_MSC_VER
)

347 ià(
	`qu”y_sgx_¡©us
() < 0) {

349 
	`´štf
("Enter‡ character beforeƒxit ...\n");

350 
	`g‘ch¬
();

356 if(
	`š™Ÿlize_’şave
() < 0){

357 
	`´štf
("Enter‡ character beforeƒxit ...\n");

358 
	`g‘ch¬
();

363 
	#SWAP_AREA
 0x900000000ULL

	)

365 if((*)
SWAP_AREA
 !ğ
	`Vœtu®AÎoc
((*)SWAP_AREA, 4096, 
MEM_RESERVE
 | 
MEM_COMMIT
, 
PAGE_READWRITE
)){

366 
	`´štf
("Swap‡llocation failed\n");

371 *
v®
 = (*)
SWAP_AREA
;

372 *(*)(
v®
 + 0xf0èğ()
	`m®loc
(64);

373 *(*)(
v®
 + 0xf8èğ()
	`m®loc
(8192);

374 *(*)(
v®
 + 0xf8) += (8192 - 1024- 8);

377 
	`eÿÎ_maš
(
glob®_eid
);

381 
	`edg”8r_¬¿y_©Œibu‹s
();

382 
	`edg”8r_poš‹r_©Œibu‹s
();

383 
	`edg”8r_ty³_©Œibu‹s
();

384 
	`edg”8r_funùiÚ_©Œibu‹s
();

387 
	`eÿÎ_libc_funùiÚs
();

388 
	`eÿÎ_libcxx_funùiÚs
();

389 
	`eÿÎ_th»ad_funùiÚs
();

392 
	`sgx_de¡roy_’şave
(
glob®_eid
);

399 
	}
}

	@App/App.h

26 #iâdeà
_APP_H_


27 
	#_APP_H_


	)

29 
	~<as£¹.h
>

30 
	~<¡dio.h
>

31 
	~<¡dlib.h
>

32 
	~<¡d¬g.h
>

34 
	~"sgx_”rÜ.h
"

35 
	~"sgx_eid.h
"

37 #iâdeà
TRUE


38 
	#TRUE
 1

	)

41 #iâdeà
FALSE


42 
	#FALSE
 0

	)

45 #ià
defšed
(
_MSC_VER
)

46 
	#TOKEN_FILENAME
 "Enşave.tok’"

	)

47 
	#ENCLAVE_FILENAME
 "Enşave.sigÃd.dÎ"

	)

48 #–ià
defšed
(
__GNUC__
)

49 
	#TOKEN_FILENAME
 "’şave.tok’"

	)

50 
	#ENCLAVE_FILENAME
 "’şave.sigÃd.so"

	)

53 
sgx_’şave_id_t
 
glob®_eid
;

55 #ià
defšed
(
__ılu¥lus
)

59 
edg”8r_¬¿y_©Œibu‹s
();

60 
edg”8r_ty³_©Œibu‹s
();

61 
edg”8r_poš‹r_©Œibu‹s
();

62 
edg”8r_funùiÚ_©Œibu‹s
();

64 
eÿÎ_libc_funùiÚs
();

65 
eÿÎ_libcxx_funùiÚs
();

66 
eÿÎ_th»ad_funùiÚs
();

68 #ià
defšed
(
__ılu¥lus
)

	@App/Edger8rSyntax/Arrays.cpp

26 
	~"../Aµ.h
"

27 
	~"Enşave_u.h
"

32 
	$edg”8r_¬¿y_©Œibu‹s
()

34 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

37 
¬r1
[4] = {0, 1, 2, 3};

38 
»t
 = 
	`eÿÎ_¬¿y_u£r_check
(
glob®_eid
, 
¬r1
);

39 ià(
»t
 !ğ
SGX_SUCCESS
)

40 
	`abÜt
();

43 
i
 = 0; i < 4; i++)

44 
	`as£¹
(
¬r1
[
i
] == (3 - i));

47 
¬r2
[4] = {0, 1, 2, 3};

48 
»t
 = 
	`eÿÎ_¬¿y_š
(
glob®_eid
, 
¬r2
);

49 ià(
»t
 !ğ
SGX_SUCCESS
)

50 
	`abÜt
();

53 
i
 = 0; i < 4; i++)

54 
	`as£¹
(
¬r2
[
i
] == i);

57 
¬r3
[4] = {0, 1, 2, 3};

58 
»t
 = 
	`eÿÎ_¬¿y_out
(
glob®_eid
, 
¬r3
);

59 ià(
»t
 !ğ
SGX_SUCCESS
)

60 
	`abÜt
();

63 
i
 = 0; i < 4; i++)

64 
	`as£¹
(
¬r3
[
i
] == (3 - i));

67 
¬r4
[4] = {0, 1, 2, 3};

68 
»t
 = 
	`eÿÎ_¬¿y_š_out
(
glob®_eid
, 
¬r4
);

69 ià(
»t
 !ğ
SGX_SUCCESS
)

70 
	`abÜt
();

73 
i
 = 0; i < 4; i++)

74 
	`as£¹
(
¬r4
[
i
] == (3 - i));

77 
¬¿y_t
 
¬r5
 = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};

78 
»t
 = 
	`eÿÎ_¬¿y_i§ry
(
glob®_eid
, 
¬r5
);

79 ià(
»t
 !ğ
SGX_SUCCESS
)

80 
	`abÜt
();

83 
i
 = 0; i < 10; i++)

84 
	`as£¹
(
¬r5
[
i
] == (9 - i));

85 
	}
}

	@App/Edger8rSyntax/Functions.cpp

26 
	~"../Aµ.h
"

27 
	~"Enşave_u.h
"

35 
	$edg”8r_funùiÚ_©Œibu‹s
()

37 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

39 
»t
 = 
	`eÿÎ_funùiÚ_ÿÎšg_cÚvs
(
glob®_eid
);

40 ià(
»t
 !ğ
SGX_SUCCESS
)

41 
	`abÜt
();

43 
»t
 = 
	`eÿÎ_funùiÚ_public
(
glob®_eid
);

44 ià(
»t
 !ğ
SGX_SUCCESS
)

45 
	`abÜt
();

48 
ruÂed
 = 0;

49 
»t
 = 
	`eÿÎ_funùiÚ_´iv©e
(
glob®_eid
, &
ruÂed
);

50 ià(
»t
 !ğ
SGX_ERROR_ECALL_NOT_ALLOWED
 || 
ruÂed
 != 0)

51 
	`abÜt
();

52 
	}
}

57 
	$oÿÎ_funùiÚ_®low
()

59 
ruÂed
 = 0;

60 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

62 
»t
 = 
	`eÿÎ_funùiÚ_´iv©e
(
glob®_eid
, &
ruÂed
);

63 ià(
»t
 !ğ
SGX_SUCCESS
 || 
ruÂed
 != 1)

64 
	`abÜt
();

65 
	}
}

	@App/Edger8rSyntax/Pointers.cpp

26 
	~"../Aµ.h
"

27 
	~"Enşave_u.h
"

32 
	$edg”8r_poš‹r_©Œibu‹s
()

34 
v®
 = 0;

35 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

37 
c
[128] = {0};

38 
size_t
 
Ën
 = 0;

39 
	`mem£t
(
c
, 0xe, 128);

40 
»t
 = 
	`eÿÎ_poš‹r_u£r_check
(
glob®_eid
, &
Ën
, &
c
, 128);

41 ià(
»t
 !ğ
SGX_SUCCESS
)

42 
	`abÜt
();

43 
	`as£¹
(
	`¡rcmp
(
c
, "SGX_SUCCESS") == 0);

46 
v®
 = 0;

47 
»t
 = 
	`eÿÎ_poš‹r_š
(
glob®_eid
, &
v®
);

48 ià(
»t
 !ğ
SGX_SUCCESS
)

49 
	`abÜt
();

50 
	`as£¹
(
v®
 == 0);

52 
v®
 = 0;

53 
»t
 = 
	`eÿÎ_poš‹r_out
(
glob®_eid
, &
v®
);

54 ià(
»t
 !ğ
SGX_SUCCESS
)

55 
	`abÜt
();

56 
	`as£¹
(
v®
 == 1234);

58 
v®
 = 0;

59 
»t
 = 
	`eÿÎ_poš‹r_š_out
(
glob®_eid
, &
v®
);

60 ià(
»t
 !ğ
SGX_SUCCESS
)

61 
	`abÜt
();

62 
	`as£¹
(
v®
 == 1234);

64 
»t
 = 
	`oÿÎ_poš‹r_©Œ
(
glob®_eid
);

65 ià(
»t
 !ğ
SGX_SUCCESS
)

66 
	`abÜt
();

68 
¡r1
[] = "1234567890";

69 
»t
 = 
	`eÿÎ_poš‹r_¡ršg
(
glob®_eid
, 
¡r1
);

70 ià(
»t
 !ğ
SGX_SUCCESS
)

71 
	`abÜt
();

72 
	`as£¹
(
	`¡¾’
(
¡r1
è=ğ10 && 
	`memcmp
(str1, "0987654321", strlen(str1)) == 0);

74 cÚ¡ 
¡r2
[] = "1234567890";

75 
»t
 = 
	`eÿÎ_poš‹r_¡ršg_cÚ¡
(
glob®_eid
, 
¡r2
);

76 ià(
»t
 !ğ
SGX_SUCCESS
)

77 
	`abÜt
();

78 
	`as£¹
(
	`¡¾’
(
¡r2
è=ğ10 && 
	`memcmp
(str2, "1234567890", strlen(str2)) == 0);

80 
¡r3
[] = "1234567890";

81 
»t
 = 
	`eÿÎ_poš‹r_size
(
glob®_eid
, (*)
¡r3
, 
	`¡¾’
(str3));

82 ià(
»t
 !ğ
SGX_SUCCESS
)

83 
	`abÜt
();

84 
	`as£¹
(
	`¡¾’
(
¡r3
è=ğ10 && 
	`memcmp
(str3, "0987654321", strlen(str3)) == 0);

86 
¡r4
[] = "1234567890";

87 
»t
 = 
	`eÿÎ_poš‹r_i¥Œ_»adÚly
(
glob®_eid
, (
bufãr_t
)
¡r4
, 
	`¡¾’
(str4));

88 ià(
»t
 !ğ
SGX_SUCCESS
)

89 
	`abÜt
();

90 
	`as£¹
(
	`¡¾’
(
¡r4
è=ğ10 && 
	`memcmp
(str4, "1234567890", strlen(str4)) == 0);

92 
¬r
[10] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};

93 
»t
 = 
	`eÿÎ_poš‹r_couÁ
(
glob®_eid
, 
¬r
, 10);

94 ià(
»t
 !ğ
SGX_SUCCESS
)

95 
	`abÜt
();

97 
i
 = 0; i < 10; i++)

98 
	`as£¹
(
¬r
[
i
] == (9 - i));

100 
	`mem£t
(
¬r
, 0x0, (arr));

101 
»t
 = 
	`eÿÎ_poš‹r_sizefunc
(
glob®_eid
, (*)
¬r
);

102 ià(
»t
 !ğ
SGX_SUCCESS
)

103 
	`abÜt
();

105 
i
 = 0; i < 10; i++)

106 
	`as£¹
(
¬r
[
i
] == i);

109 
	}
}

114 
	$oÿÎ_poš‹r_u£r_check
(* 
v®
)

116 ()
v®
;

117 
	`as£¹
(
v®
 !ğ
NULL
);

118 
	}
}

123 
	$oÿÎ_poš‹r_š
(* 
v®
)

125 *
v®
 = 1234;

126 
	}
}

131 
	$oÿÎ_poš‹r_out
(* 
v®
)

133 *
v®
 = 1234;

134 
	}
}

139 
	$oÿÎ_poš‹r_š_out
(* 
v®
)

141 *
v®
 = 1234;

142 
	}
}

	@App/Edger8rSyntax/Types.cpp

26 
	~"../Aµ.h
"

27 
	~"Enşave_u.h
"

32 
	$edg”8r_ty³_©Œibu‹s
()

34 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

36 
»t
 = 
	`eÿÎ_ty³_ch¬
(
glob®_eid
, ()0x12);

37 ià(
»t
 !ğ
SGX_SUCCESS
)

38 
	`abÜt
();

40 
»t
 = 
	`eÿÎ_ty³_št
(
glob®_eid
, ()1234);

41 ià(
»t
 !ğ
SGX_SUCCESS
)

42 
	`abÜt
();

44 
»t
 = 
	`eÿÎ_ty³_æßt
(
glob®_eid
, ()1234.0);

45 ià(
»t
 !ğ
SGX_SUCCESS
)

46 
	`abÜt
();

48 
»t
 = 
	`eÿÎ_ty³_doubË
(
glob®_eid
, ()1234.5678);

49 ià(
»t
 !ğ
SGX_SUCCESS
)

50 
	`abÜt
();

52 
»t
 = 
	`eÿÎ_ty³_size_t
(
glob®_eid
, (
size_t
)12345678);

53 ià(
»t
 !ğ
SGX_SUCCESS
)

54 
	`abÜt
();

56 
»t
 = 
	`eÿÎ_ty³_wch¬_t
(
glob®_eid
, (
wch¬_t
)0x1234);

57 ià(
»t
 !ğ
SGX_SUCCESS
)

58 
	`abÜt
();

60 
¡ruù_foo_t
 
g
 = {1234, 5678};

61 
»t
 = 
	`eÿÎ_ty³_¡ruù
(
glob®_eid
, 
g
);

62 ià(
»t
 !ğ
SGX_SUCCESS
)

63 
	`abÜt
();

65 
uniÚ_foo_t
 
v®
 = {0};

66 
»t
 = 
	`eÿÎ_ty³_’um_uniÚ
(
glob®_eid
, 
ENUM_FOO_0
, &
v®
);

67 ià(
»t
 !ğ
SGX_SUCCESS
)

68 
	`abÜt
();

69 
	`as£¹
(
v®
.
uniÚ_foo_0
 == 2);

70 
	}
}

	@App/Enclave_u.c

1 
	~"Enşave_u.h
"

2 
	~<”ºo.h
>

5 
	sms_eÿÎ_ty³_ch¬_t
 {

6 
	mms_v®
;

7 } 
	tms_eÿÎ_ty³_ch¬_t
;

9 
	sms_eÿÎ_ty³_št_t
 {

10 
	mms_v®
;

11 } 
	tms_eÿÎ_ty³_št_t
;

13 
	sms_eÿÎ_ty³_æßt_t
 {

14 
	mms_v®
;

15 } 
	tms_eÿÎ_ty³_æßt_t
;

17 
	sms_eÿÎ_ty³_doubË_t
 {

18 
	mms_v®
;

19 } 
	tms_eÿÎ_ty³_doubË_t
;

21 
	sms_eÿÎ_ty³_size_t_t
 {

22 
size_t
 
	mms_v®
;

23 } 
	tms_eÿÎ_ty³_size_t_t
;

25 
	sms_eÿÎ_ty³_wch¬_t_t
 {

26 
wch¬_t
 
	mms_v®
;

27 } 
	tms_eÿÎ_ty³_wch¬_t_t
;

29 
	sms_eÿÎ_ty³_¡ruù_t
 {

30 
¡ruù_foo_t
 
	mms_v®
;

31 } 
	tms_eÿÎ_ty³_¡ruù_t
;

33 
	sms_eÿÎ_ty³_’um_uniÚ_t
 {

34 
’um_foo_t
 
	mms_v®1
;

35 
uniÚ_foo_t
* 
	mms_v®2
;

36 } 
	tms_eÿÎ_ty³_’um_uniÚ_t
;

38 
	sms_eÿÎ_poš‹r_u£r_check_t
 {

39 
size_t
 
	mms_»tv®
;

40 * 
	mms_v®
;

41 
size_t
 
	mms_sz
;

42 } 
	tms_eÿÎ_poš‹r_u£r_check_t
;

44 
	sms_eÿÎ_poš‹r_š_t
 {

45 * 
	mms_v®
;

46 } 
	tms_eÿÎ_poš‹r_š_t
;

48 
	sms_eÿÎ_poš‹r_out_t
 {

49 * 
	mms_v®
;

50 } 
	tms_eÿÎ_poš‹r_out_t
;

52 
	sms_eÿÎ_poš‹r_š_out_t
 {

53 * 
	mms_v®
;

54 } 
	tms_eÿÎ_poš‹r_š_out_t
;

56 
	sms_eÿÎ_poš‹r_¡ršg_t
 {

57 * 
	mms_¡r
;

58 } 
	tms_eÿÎ_poš‹r_¡ršg_t
;

60 
	sms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
 {

61 * 
	mms_¡r
;

62 } 
	tms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
;

64 
	sms_eÿÎ_poš‹r_size_t
 {

65 * 
	mms_±r
;

66 
size_t
 
	mms_Ën
;

67 } 
	tms_eÿÎ_poš‹r_size_t
;

69 
	sms_eÿÎ_poš‹r_couÁ_t
 {

70 * 
	mms_¬r
;

71 
	mms_út
;

72 } 
	tms_eÿÎ_poš‹r_couÁ_t
;

74 
	sms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
 {

75 
bufãr_t
 
	mms_buf
;

76 
size_t
 
	mms_Ën
;

77 } 
	tms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
;

79 
	sms_eÿÎ_poš‹r_sizefunc_t
 {

80 * 
	mms_buf
;

81 } 
	tms_eÿÎ_poš‹r_sizefunc_t
;

84 
	sms_eÿÎ_¬¿y_u£r_check_t
 {

85 * 
	mms_¬r
;

86 } 
	tms_eÿÎ_¬¿y_u£r_check_t
;

88 
	sms_eÿÎ_¬¿y_š_t
 {

89 * 
	mms_¬r
;

90 } 
	tms_eÿÎ_¬¿y_š_t
;

92 
	sms_eÿÎ_¬¿y_out_t
 {

93 * 
	mms_¬r
;

94 } 
	tms_eÿÎ_¬¿y_out_t
;

96 
	sms_eÿÎ_¬¿y_š_out_t
 {

97 * 
	mms_¬r
;

98 } 
	tms_eÿÎ_¬¿y_š_out_t
;

100 
	sms_eÿÎ_¬¿y_i§ry_t
 {

101 
¬¿y_t
* 
	mms_¬r
;

102 } 
	tms_eÿÎ_¬¿y_i§ry_t
;

106 
	sms_eÿÎ_funùiÚ_´iv©e_t
 {

107 
	mms_»tv®
;

108 } 
	tms_eÿÎ_funùiÚ_´iv©e_t
;

111 
	sms_eÿÎ_sgx_ıuid_t
 {

112 * 
	mms_ıušfo
;

113 
	mms_Ëaf
;

114 } 
	tms_eÿÎ_sgx_ıuid_t
;

118 
	sms_eÿÎ_šü—£_couÁ”_t
 {

119 
size_t
 
	mms_»tv®
;

120 } 
	tms_eÿÎ_šü—£_couÁ”_t
;

124 
	sms_oÿÎ_´št_¡ršg_t
 {

125 * 
	mms_¡r
;

126 } 
	tms_oÿÎ_´št_¡ršg_t
;

128 
	sms_oÿÎ_g’”ic_t
 {

129 
	mms_»tv®
;

130 
	mms_±r
;

131 } 
	tms_oÿÎ_g’”ic_t
;

133 
	sms_oÿÎ_poš‹r_u£r_check_t
 {

134 * 
	mms_v®
;

135 } 
	tms_oÿÎ_poš‹r_u£r_check_t
;

137 
	sms_oÿÎ_poš‹r_š_t
 {

138 * 
	mms_v®
;

139 } 
	tms_oÿÎ_poš‹r_š_t
;

141 
	sms_oÿÎ_poš‹r_out_t
 {

142 * 
	mms_v®
;

143 } 
	tms_oÿÎ_poš‹r_out_t
;

145 
	sms_oÿÎ_poš‹r_š_out_t
 {

146 * 
	mms_v®
;

147 } 
	tms_oÿÎ_poš‹r_š_out_t
;

149 
	sms_memcıy_t
 {

150 * 
	mms_»tv®
;

151 * 
	mms_de¡
;

152 * 
	mms_¤c
;

153 
	mms_v®
;

154 
size_t
 
	mms_Ën
;

155 } 
	tms_memcıy_t
;

158 
	sms_sgx_oc_ıuidex_t
 {

159 * 
	mms_ıušfo
;

160 
	mms_Ëaf
;

161 
	mms_subËaf
;

162 } 
	tms_sgx_oc_ıuidex_t
;

164 
	sms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
 {

165 
	mms_»tv®
;

166 * 
	mms_£lf
;

167 } 
	tms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
;

169 
	sms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
 {

170 
	mms_»tv®
;

171 * 
	mms_wa™”
;

172 } 
	tms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
;

174 
	sms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
 {

175 
	mms_»tv®
;

176 * 
	mms_wa™”
;

177 * 
	mms_£lf
;

178 } 
	tms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
;

180 
	sms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
 {

181 
	mms_»tv®
;

182 ** 
	mms_wa™”s
;

183 
size_t
 
	mms_tÙ®
;

184 } 
	tms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
;

186 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_´št_¡ršg
(* 
pms
)

188 
ms_oÿÎ_´št_¡ršg_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_´št_¡ršg_t*, 
pms
);

189 
	`oÿÎ_´št_¡ršg
((cÚ¡ *)
ms
->
ms_¡r
);

191  
SGX_SUCCESS
;

192 
	}
}

194 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_g’”ic
(* 
pms
)

196 
ms_oÿÎ_g’”ic_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_g’”ic_t*, 
pms
);

197 
ms
->
ms_»tv®
 = 
	`oÿÎ_g’”ic
(ms->
ms_±r
);

199  
SGX_SUCCESS
;

200 
	}
}

202 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_poš‹r_u£r_check
(* 
pms
)

204 
ms_oÿÎ_poš‹r_u£r_check_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_poš‹r_u£r_check_t*, 
pms
);

205 
	`oÿÎ_poš‹r_u£r_check
(
ms
->
ms_v®
);

207  
SGX_SUCCESS
;

208 
	}
}

210 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_poš‹r_š
(* 
pms
)

212 
ms_oÿÎ_poš‹r_š_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_poš‹r_š_t*, 
pms
);

213 
	`oÿÎ_poš‹r_š
(
ms
->
ms_v®
);

215  
SGX_SUCCESS
;

216 
	}
}

218 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_poš‹r_out
(* 
pms
)

220 
ms_oÿÎ_poš‹r_out_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_poš‹r_out_t*, 
pms
);

221 
	`oÿÎ_poš‹r_out
(
ms
->
ms_v®
);

223  
SGX_SUCCESS
;

224 
	}
}

226 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_poš‹r_š_out
(* 
pms
)

228 
ms_oÿÎ_poš‹r_š_out_t
* 
ms
 = 
	`SGX_CAST
(ms_oÿÎ_poš‹r_š_out_t*, 
pms
);

229 
	`oÿÎ_poš‹r_š_out
(
ms
->
ms_v®
);

231  
SGX_SUCCESS
;

232 
	}
}

234 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_memcıy
(* 
pms
)

236 
ms_memcıy_t
* 
ms
 = 
	`SGX_CAST
(ms_memcıy_t*, 
pms
);

237 
ms
->
ms_»tv®
 = 
	`memcıy
(ms->
ms_de¡
, (cÚ¡ *)ms->
ms_¤c
, ms->
ms_v®
, ms->
ms_Ën
);

239  
SGX_SUCCESS
;

240 
	}
}

242 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_oÿÎ_funùiÚ_®low
(* 
pms
)

244 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

245 
	`oÿÎ_funùiÚ_®low
();

246  
SGX_SUCCESS
;

247 
	}
}

249 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_sgx_oc_ıuidex
(* 
pms
)

251 
ms_sgx_oc_ıuidex_t
* 
ms
 = 
	`SGX_CAST
(ms_sgx_oc_ıuidex_t*, 
pms
);

252 
	`sgx_oc_ıuidex
(
ms
->
ms_ıušfo
, ms->
ms_Ëaf
, ms->
ms_subËaf
);

254  
SGX_SUCCESS
;

255 
	}
}

257 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
(* 
pms
)

259 
ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
* 
ms
 = 
	`SGX_CAST
(ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t*, 
pms
);

260 
ms
->
ms_»tv®
 = 
	`sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
((cÚ¡ *)ms->
ms_£lf
);

262  
SGX_SUCCESS
;

263 
	}
}

265 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
(* 
pms
)

267 
ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
* 
ms
 = 
	`SGX_CAST
(ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t*, 
pms
);

268 
ms
->
ms_»tv®
 = 
	`sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
((cÚ¡ *)ms->
ms_wa™”
);

270  
SGX_SUCCESS
;

271 
	}
}

273 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
(* 
pms
)

275 
ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
* 
ms
 = 
	`SGX_CAST
(ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t*, 
pms
);

276 
ms
->
ms_»tv®
 = 
	`sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
((cÚ¡ *)ms->
ms_wa™”
, (cÚ¡ *)ms->
ms_£lf
);

278  
SGX_SUCCESS
;

279 
	}
}

281 
sgx_¡©us_t
 
SGX_CDECL
 
	$Enşave_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
(* 
pms
)

283 
ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
* 
ms
 = 
	`SGX_CAST
(ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t*, 
pms
);

284 
ms
->
ms_»tv®
 = 
	`sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
((cÚ¡ **)ms->
ms_wa™”s
, ms->
ms_tÙ®
);

286  
SGX_SUCCESS
;

287 
	}
}

290 
size_t
 
	mÄ_oÿÎ
;

291 * 
	mfunc_addr
[13];

292 } 
	goÿÎ_bË_Enşave
 = {

295 (*)(
ušŒ_t
)
Enşave_oÿÎ_´št_¡ršg
,

296 (*)(
ušŒ_t
)
Enşave_oÿÎ_g’”ic
,

297 (*)(
ušŒ_t
)
Enşave_oÿÎ_poš‹r_u£r_check
,

298 (*)(
ušŒ_t
)
Enşave_oÿÎ_poš‹r_š
,

299 (*)(
ušŒ_t
)
Enşave_oÿÎ_poš‹r_out
,

300 (*)(
ušŒ_t
)
Enşave_oÿÎ_poš‹r_š_out
,

301 (*)(
ušŒ_t
)
Enşave_memcıy
,

302 (*)(
ušŒ_t
)
Enşave_oÿÎ_funùiÚ_®low
,

303 (*)(
ušŒ_t
)
Enşave_sgx_oc_ıuidex
,

304 (*)(
ušŒ_t
)
Enşave_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
,

305 (*)(
ušŒ_t
)
Enşave_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
,

306 (*)(
ušŒ_t
)
Enşave_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
,

307 (*)(
ušŒ_t
)
Enşave_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
,

311 
sgx_¡©us_t
 
	$eÿÎ_maš
(
sgx_’şave_id_t
 
eid
)

313 
sgx_¡©us_t
 
¡©us
;

314 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 0, &
oÿÎ_bË_Enşave
, 
NULL
);

315  
¡©us
;

316 
	}
}

318 
sgx_¡©us_t
 
	$eÿÎ_ty³_ch¬
(
sgx_’şave_id_t
 
eid
, 
v®
)

320 
sgx_¡©us_t
 
¡©us
;

321 
ms_eÿÎ_ty³_ch¬_t
 
ms
;

322 
ms
.
ms_v®
 = 
v®
;

323 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 1, &
oÿÎ_bË_Enşave
, &
ms
);

324  
¡©us
;

325 
	}
}

327 
sgx_¡©us_t
 
	$eÿÎ_ty³_št
(
sgx_’şave_id_t
 
eid
, 
v®
)

329 
sgx_¡©us_t
 
¡©us
;

330 
ms_eÿÎ_ty³_št_t
 
ms
;

331 
ms
.
ms_v®
 = 
v®
;

332 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 2, &
oÿÎ_bË_Enşave
, &
ms
);

333  
¡©us
;

334 
	}
}

336 
sgx_¡©us_t
 
	$eÿÎ_ty³_æßt
(
sgx_’şave_id_t
 
eid
, 
v®
)

338 
sgx_¡©us_t
 
¡©us
;

339 
ms_eÿÎ_ty³_æßt_t
 
ms
;

340 
ms
.
ms_v®
 = 
v®
;

341 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 3, &
oÿÎ_bË_Enşave
, &
ms
);

342  
¡©us
;

343 
	}
}

345 
sgx_¡©us_t
 
	$eÿÎ_ty³_doubË
(
sgx_’şave_id_t
 
eid
, 
v®
)

347 
sgx_¡©us_t
 
¡©us
;

348 
ms_eÿÎ_ty³_doubË_t
 
ms
;

349 
ms
.
ms_v®
 = 
v®
;

350 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 4, &
oÿÎ_bË_Enşave
, &
ms
);

351  
¡©us
;

352 
	}
}

354 
sgx_¡©us_t
 
	$eÿÎ_ty³_size_t
(
sgx_’şave_id_t
 
eid
, 
size_t
 
v®
)

356 
sgx_¡©us_t
 
¡©us
;

357 
ms_eÿÎ_ty³_size_t_t
 
ms
;

358 
ms
.
ms_v®
 = 
v®
;

359 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 5, &
oÿÎ_bË_Enşave
, &
ms
);

360  
¡©us
;

361 
	}
}

363 
sgx_¡©us_t
 
	$eÿÎ_ty³_wch¬_t
(
sgx_’şave_id_t
 
eid
, 
wch¬_t
 
v®
)

365 
sgx_¡©us_t
 
¡©us
;

366 
ms_eÿÎ_ty³_wch¬_t_t
 
ms
;

367 
ms
.
ms_v®
 = 
v®
;

368 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 6, &
oÿÎ_bË_Enşave
, &
ms
);

369  
¡©us
;

370 
	}
}

372 
sgx_¡©us_t
 
	$eÿÎ_ty³_¡ruù
(
sgx_’şave_id_t
 
eid
, 
¡ruù_foo_t
 
v®
)

374 
sgx_¡©us_t
 
¡©us
;

375 
ms_eÿÎ_ty³_¡ruù_t
 
ms
;

376 
ms
.
ms_v®
 = 
v®
;

377 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 7, &
oÿÎ_bË_Enşave
, &
ms
);

378  
¡©us
;

379 
	}
}

381 
sgx_¡©us_t
 
	$eÿÎ_ty³_’um_uniÚ
(
sgx_’şave_id_t
 
eid
, 
’um_foo_t
 
v®1
, 
uniÚ_foo_t
* 
v®2
)

383 
sgx_¡©us_t
 
¡©us
;

384 
ms_eÿÎ_ty³_’um_uniÚ_t
 
ms
;

385 
ms
.
ms_v®1
 = 
v®1
;

386 
ms
.
ms_v®2
 = 
v®2
;

387 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 8, &
oÿÎ_bË_Enşave
, &
ms
);

388  
¡©us
;

389 
	}
}

391 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_u£r_check
(
sgx_’şave_id_t
 
eid
, 
size_t
* 
»tv®
, * 
v®
, size_ˆ
sz
)

393 
sgx_¡©us_t
 
¡©us
;

394 
ms_eÿÎ_poš‹r_u£r_check_t
 
ms
;

395 
ms
.
ms_v®
 = 
v®
;

396 
ms
.
ms_sz
 = 
sz
;

397 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 9, &
oÿÎ_bË_Enşave
, &
ms
);

398 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

399  
¡©us
;

400 
	}
}

402 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_š
(
sgx_’şave_id_t
 
eid
, * 
v®
)

404 
sgx_¡©us_t
 
¡©us
;

405 
ms_eÿÎ_poš‹r_š_t
 
ms
;

406 
ms
.
ms_v®
 = 
v®
;

407 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 10, &
oÿÎ_bË_Enşave
, &
ms
);

408  
¡©us
;

409 
	}
}

411 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_out
(
sgx_’şave_id_t
 
eid
, * 
v®
)

413 
sgx_¡©us_t
 
¡©us
;

414 
ms_eÿÎ_poš‹r_out_t
 
ms
;

415 
ms
.
ms_v®
 = 
v®
;

416 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 11, &
oÿÎ_bË_Enşave
, &
ms
);

417  
¡©us
;

418 
	}
}

420 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_š_out
(
sgx_’şave_id_t
 
eid
, * 
v®
)

422 
sgx_¡©us_t
 
¡©us
;

423 
ms_eÿÎ_poš‹r_š_out_t
 
ms
;

424 
ms
.
ms_v®
 = 
v®
;

425 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 12, &
oÿÎ_bË_Enşave
, &
ms
);

426  
¡©us
;

427 
	}
}

429 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_¡ršg
(
sgx_’şave_id_t
 
eid
, * 
¡r
)

431 
sgx_¡©us_t
 
¡©us
;

432 
ms_eÿÎ_poš‹r_¡ršg_t
 
ms
;

433 
ms
.
ms_¡r
 = 
¡r
;

434 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 13, &
oÿÎ_bË_Enşave
, &
ms
);

435  
¡©us
;

436 
	}
}

438 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_¡ršg_cÚ¡
(
sgx_’şave_id_t
 
eid
, cÚ¡ * 
¡r
)

440 
sgx_¡©us_t
 
¡©us
;

441 
ms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
 
ms
;

442 
ms
.
ms_¡r
 = (*)
¡r
;

443 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 14, &
oÿÎ_bË_Enşave
, &
ms
);

444  
¡©us
;

445 
	}
}

447 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_size
(
sgx_’şave_id_t
 
eid
, * 
±r
, 
size_t
 
Ën
)

449 
sgx_¡©us_t
 
¡©us
;

450 
ms_eÿÎ_poš‹r_size_t
 
ms
;

451 
ms
.
ms_±r
 = 
±r
;

452 
ms
.
ms_Ën
 = 
Ën
;

453 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 15, &
oÿÎ_bË_Enşave
, &
ms
);

454  
¡©us
;

455 
	}
}

457 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_couÁ
(
sgx_’şave_id_t
 
eid
, * 
¬r
, 
út
)

459 
sgx_¡©us_t
 
¡©us
;

460 
ms_eÿÎ_poš‹r_couÁ_t
 
ms
;

461 
ms
.
ms_¬r
 = 
¬r
;

462 
ms
.
ms_út
 = 
út
;

463 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 16, &
oÿÎ_bË_Enşave
, &
ms
);

464  
¡©us
;

465 
	}
}

467 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_i¥Œ_»adÚly
(
sgx_’şave_id_t
 
eid
, 
bufãr_t
 
buf
, 
size_t
 
Ën
)

469 
sgx_¡©us_t
 
¡©us
;

470 
ms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
 
ms
;

471 
ms
.
ms_buf
 = (
bufãr_t
)
buf
;

472 
ms
.
ms_Ën
 = 
Ën
;

473 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 17, &
oÿÎ_bË_Enşave
, &
ms
);

474  
¡©us
;

475 
	}
}

477 
sgx_¡©us_t
 
	$eÿÎ_poš‹r_sizefunc
(
sgx_’şave_id_t
 
eid
, * 
buf
)

479 
sgx_¡©us_t
 
¡©us
;

480 
ms_eÿÎ_poš‹r_sizefunc_t
 
ms
;

481 
ms
.
ms_buf
 = 
buf
;

482 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 18, &
oÿÎ_bË_Enşave
, &
ms
);

483  
¡©us
;

484 
	}
}

486 
sgx_¡©us_t
 
	$oÿÎ_poš‹r_©Œ
(
sgx_’şave_id_t
 
eid
)

488 
sgx_¡©us_t
 
¡©us
;

489 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 19, &
oÿÎ_bË_Enşave
, 
NULL
);

490  
¡©us
;

491 
	}
}

493 
sgx_¡©us_t
 
	$eÿÎ_¬¿y_u£r_check
(
sgx_’şave_id_t
 
eid
, 
¬r
[4])

495 
sgx_¡©us_t
 
¡©us
;

496 
ms_eÿÎ_¬¿y_u£r_check_t
 
ms
;

497 
ms
.
ms_¬r
 = (*)
¬r
;

498 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 20, &
oÿÎ_bË_Enşave
, &
ms
);

499  
¡©us
;

500 
	}
}

502 
sgx_¡©us_t
 
	$eÿÎ_¬¿y_š
(
sgx_’şave_id_t
 
eid
, 
¬r
[4])

504 
sgx_¡©us_t
 
¡©us
;

505 
ms_eÿÎ_¬¿y_š_t
 
ms
;

506 
ms
.
ms_¬r
 = (*)
¬r
;

507 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 21, &
oÿÎ_bË_Enşave
, &
ms
);

508  
¡©us
;

509 
	}
}

511 
sgx_¡©us_t
 
	$eÿÎ_¬¿y_out
(
sgx_’şave_id_t
 
eid
, 
¬r
[4])

513 
sgx_¡©us_t
 
¡©us
;

514 
ms_eÿÎ_¬¿y_out_t
 
ms
;

515 
ms
.
ms_¬r
 = (*)
¬r
;

516 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 22, &
oÿÎ_bË_Enşave
, &
ms
);

517  
¡©us
;

518 
	}
}

520 
sgx_¡©us_t
 
	$eÿÎ_¬¿y_š_out
(
sgx_’şave_id_t
 
eid
, 
¬r
[4])

522 
sgx_¡©us_t
 
¡©us
;

523 
ms_eÿÎ_¬¿y_š_out_t
 
ms
;

524 
ms
.
ms_¬r
 = (*)
¬r
;

525 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 23, &
oÿÎ_bË_Enşave
, &
ms
);

526  
¡©us
;

527 
	}
}

529 
sgx_¡©us_t
 
	$eÿÎ_¬¿y_i§ry
(
sgx_’şave_id_t
 
eid
, 
¬¿y_t
 
¬r
)

531 
sgx_¡©us_t
 
¡©us
;

532 
ms_eÿÎ_¬¿y_i§ry_t
 
ms
;

533 
ms
.
ms_¬r
 = (
¬¿y_t
 *)&
¬r
[0];

534 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 24, &
oÿÎ_bË_Enşave
, &
ms
);

535  
¡©us
;

536 
	}
}

538 
sgx_¡©us_t
 
	$eÿÎ_funùiÚ_ÿÎšg_cÚvs
(
sgx_’şave_id_t
 
eid
)

540 
sgx_¡©us_t
 
¡©us
;

541 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 25, &
oÿÎ_bË_Enşave
, 
NULL
);

542  
¡©us
;

543 
	}
}

545 
sgx_¡©us_t
 
	$eÿÎ_funùiÚ_public
(
sgx_’şave_id_t
 
eid
)

547 
sgx_¡©us_t
 
¡©us
;

548 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 26, &
oÿÎ_bË_Enşave
, 
NULL
);

549  
¡©us
;

550 
	}
}

552 
sgx_¡©us_t
 
	$eÿÎ_funùiÚ_´iv©e
(
sgx_’şave_id_t
 
eid
, * 
»tv®
)

554 
sgx_¡©us_t
 
¡©us
;

555 
ms_eÿÎ_funùiÚ_´iv©e_t
 
ms
;

556 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 27, &
oÿÎ_bË_Enşave
, &
ms
);

557 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

558  
¡©us
;

559 
	}
}

561 
sgx_¡©us_t
 
	$eÿÎ_m®loc_ä“
(
sgx_’şave_id_t
 
eid
)

563 
sgx_¡©us_t
 
¡©us
;

564 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 28, &
oÿÎ_bË_Enşave
, 
NULL
);

565  
¡©us
;

566 
	}
}

568 
sgx_¡©us_t
 
	$eÿÎ_sgx_ıuid
(
sgx_’şave_id_t
 
eid
, 
ıušfo
[4], 
Ëaf
)

570 
sgx_¡©us_t
 
¡©us
;

571 
ms_eÿÎ_sgx_ıuid_t
 
ms
;

572 
ms
.
ms_ıušfo
 = (*)
ıušfo
;

573 
ms
.
ms_Ëaf
 = 
Ëaf
;

574 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 29, &
oÿÎ_bË_Enşave
, &
ms
);

575  
¡©us
;

576 
	}
}

578 
sgx_¡©us_t
 
	$eÿÎ_exû±iÚ
(
sgx_’şave_id_t
 
eid
)

580 
sgx_¡©us_t
 
¡©us
;

581 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 30, &
oÿÎ_bË_Enşave
, 
NULL
);

582  
¡©us
;

583 
	}
}

585 
sgx_¡©us_t
 
	$eÿÎ_m­
(
sgx_’şave_id_t
 
eid
)

587 
sgx_¡©us_t
 
¡©us
;

588 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 31, &
oÿÎ_bË_Enşave
, 
NULL
);

589  
¡©us
;

590 
	}
}

592 
sgx_¡©us_t
 
	$eÿÎ_šü—£_couÁ”
(
sgx_’şave_id_t
 
eid
, 
size_t
* 
»tv®
)

594 
sgx_¡©us_t
 
¡©us
;

595 
ms_eÿÎ_šü—£_couÁ”_t
 
ms
;

596 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 32, &
oÿÎ_bË_Enşave
, &
ms
);

597 ià(
¡©us
 =ğ
SGX_SUCCESS
 && 
»tv®
è*»tv® = 
ms
.
ms_»tv®
;

598  
¡©us
;

599 
	}
}

601 
sgx_¡©us_t
 
	$eÿÎ_´oduûr
(
sgx_’şave_id_t
 
eid
)

603 
sgx_¡©us_t
 
¡©us
;

604 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 33, &
oÿÎ_bË_Enşave
, 
NULL
);

605  
¡©us
;

606 
	}
}

608 
sgx_¡©us_t
 
	$eÿÎ_cÚsum”
(
sgx_’şave_id_t
 
eid
)

610 
sgx_¡©us_t
 
¡©us
;

611 
¡©us
 = 
	`sgx_eÿÎ
(
eid
, 34, &
oÿÎ_bË_Enşave
, 
NULL
);

612  
¡©us
;

613 
	}
}

	@App/Enclave_u.h

1 #iâdeà
ENCLAVE_U_H__


2 
	#ENCLAVE_U_H__


	)

4 
	~<¡dšt.h
>

5 
	~<wch¬.h
>

6 
	~<¡ddef.h
>

7 
	~<¡ršg.h
>

8 
	~"sgx_edg”8r.h
"

10 
	~"u£r_ty³s.h
"

12 
	#SGX_CAST
(
ty³
, 
™em
è(Ñy³)(™em))

	)

14 #ifdeà
__ılu¥lus


18 
	s¡ruù_foo_t
 {

19 
ušt32_t
 
¡ruù_foo_0
;

20 
ušt64_t
 
¡ruù_foo_1
;

21 } 
	t¡ruù_foo_t
;

23 
	e’um_foo_t
 {

24 
ENUM_FOO_0
 = 0,

25 
ENUM_FOO_1
 = 1,

26 } 
	t’um_foo_t
;

28 
	uuniÚ_foo_t
 {

29 
ušt32_t
 
uniÚ_foo_0
;

30 
ušt32_t
 
uniÚ_foo_1
;

31 
ušt64_t
 
uniÚ_foo_3
;

32 } 
	tuniÚ_foo_t
;

34 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_´št_¡ršg
, (cÚ¡ * 
¡r
));

35 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_g’”ic
, (
±r
));

36 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_poš‹r_u£r_check
, (* 
v®
));

37 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_poš‹r_š
, (* 
v®
));

38 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_poš‹r_out
, (* 
v®
));

39 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_poš‹r_š_out
, (* 
v®
));

40 
SGX_DLLIMPORT
 * 
SGX_UBRIDGE
(
SGX_CDECL
, 
memcıy
, (* 
de¡
, cÚ¡ * 
¤c
, 
v®
, 
size_t
 
Ën
));

41 
SGX_UBRIDGE
(
SGX_NOCONVENTION
, 
oÿÎ_funùiÚ_®low
, ());

42 
SGX_UBRIDGE
(
SGX_CDECL
, 
sgx_oc_ıuidex
, (
ıušfo
[4], 
Ëaf
, 
subËaf
));

43 
SGX_UBRIDGE
(
SGX_CDECL
, 
sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
, (cÚ¡ * 
£lf
));

44 
SGX_UBRIDGE
(
SGX_CDECL
, 
sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
, (cÚ¡ * 
wa™”
));

45 
SGX_UBRIDGE
(
SGX_CDECL
, 
sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
, (cÚ¡ * 
wa™”
, cÚ¡ * 
£lf
));

46 
SGX_UBRIDGE
(
SGX_CDECL
, 
sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
, (cÚ¡ ** 
wa™”s
, 
size_t
 
tÙ®
));

48 
sgx_¡©us_t
 
eÿÎ_maš
(
sgx_’şave_id_t
 
eid
);

49 
sgx_¡©us_t
 
eÿÎ_ty³_ch¬
(
sgx_’şave_id_t
 
eid
, 
v®
);

50 
sgx_¡©us_t
 
eÿÎ_ty³_št
(
sgx_’şave_id_t
 
eid
, 
v®
);

51 
sgx_¡©us_t
 
eÿÎ_ty³_æßt
(
sgx_’şave_id_t
 
eid
, 
v®
);

52 
sgx_¡©us_t
 
eÿÎ_ty³_doubË
(
sgx_’şave_id_t
 
eid
, 
v®
);

53 
sgx_¡©us_t
 
eÿÎ_ty³_size_t
(
sgx_’şave_id_t
 
eid
, 
size_t
 
v®
);

54 
sgx_¡©us_t
 
eÿÎ_ty³_wch¬_t
(
sgx_’şave_id_t
 
eid
, 
wch¬_t
 
v®
);

55 
sgx_¡©us_t
 
eÿÎ_ty³_¡ruù
(
sgx_’şave_id_t
 
eid
, 
¡ruù_foo_t
 
v®
);

56 
sgx_¡©us_t
 
eÿÎ_ty³_’um_uniÚ
(
sgx_’şave_id_t
 
eid
, 
’um_foo_t
 
v®1
, 
uniÚ_foo_t
* 
v®2
);

57 
sgx_¡©us_t
 
eÿÎ_poš‹r_u£r_check
(
sgx_’şave_id_t
 
eid
, 
size_t
* 
»tv®
, * 
v®
, size_ˆ
sz
);

58 
sgx_¡©us_t
 
eÿÎ_poš‹r_š
(
sgx_’şave_id_t
 
eid
, * 
v®
);

59 
sgx_¡©us_t
 
eÿÎ_poš‹r_out
(
sgx_’şave_id_t
 
eid
, * 
v®
);

60 
sgx_¡©us_t
 
eÿÎ_poš‹r_š_out
(
sgx_’şave_id_t
 
eid
, * 
v®
);

61 
sgx_¡©us_t
 
eÿÎ_poš‹r_¡ršg
(
sgx_’şave_id_t
 
eid
, * 
¡r
);

62 
sgx_¡©us_t
 
eÿÎ_poš‹r_¡ršg_cÚ¡
(
sgx_’şave_id_t
 
eid
, cÚ¡ * 
¡r
);

63 
sgx_¡©us_t
 
eÿÎ_poš‹r_size
(
sgx_’şave_id_t
 
eid
, * 
±r
, 
size_t
 
Ën
);

64 
sgx_¡©us_t
 
eÿÎ_poš‹r_couÁ
(
sgx_’şave_id_t
 
eid
, * 
¬r
, 
út
);

65 
sgx_¡©us_t
 
eÿÎ_poš‹r_i¥Œ_»adÚly
(
sgx_’şave_id_t
 
eid
, 
bufãr_t
 
buf
, 
size_t
 
Ën
);

66 
sgx_¡©us_t
 
eÿÎ_poš‹r_sizefunc
(
sgx_’şave_id_t
 
eid
, * 
buf
);

67 
sgx_¡©us_t
 
oÿÎ_poš‹r_©Œ
(
sgx_’şave_id_t
 
eid
);

68 
sgx_¡©us_t
 
eÿÎ_¬¿y_u£r_check
(
sgx_’şave_id_t
 
eid
, 
¬r
[4]);

69 
sgx_¡©us_t
 
eÿÎ_¬¿y_š
(
sgx_’şave_id_t
 
eid
, 
¬r
[4]);

70 
sgx_¡©us_t
 
eÿÎ_¬¿y_out
(
sgx_’şave_id_t
 
eid
, 
¬r
[4]);

71 
sgx_¡©us_t
 
eÿÎ_¬¿y_š_out
(
sgx_’şave_id_t
 
eid
, 
¬r
[4]);

72 
sgx_¡©us_t
 
eÿÎ_¬¿y_i§ry
(
sgx_’şave_id_t
 
eid
, 
¬¿y_t
 
¬r
);

73 
sgx_¡©us_t
 
eÿÎ_funùiÚ_ÿÎšg_cÚvs
(
sgx_’şave_id_t
 
eid
);

74 
sgx_¡©us_t
 
eÿÎ_funùiÚ_public
(
sgx_’şave_id_t
 
eid
);

75 
sgx_¡©us_t
 
eÿÎ_funùiÚ_´iv©e
(
sgx_’şave_id_t
 
eid
, * 
»tv®
);

76 
sgx_¡©us_t
 
eÿÎ_m®loc_ä“
(
sgx_’şave_id_t
 
eid
);

77 
sgx_¡©us_t
 
eÿÎ_sgx_ıuid
(
sgx_’şave_id_t
 
eid
, 
ıušfo
[4], 
Ëaf
);

78 
sgx_¡©us_t
 
eÿÎ_exû±iÚ
(
sgx_’şave_id_t
 
eid
);

79 
sgx_¡©us_t
 
eÿÎ_m­
(
sgx_’şave_id_t
 
eid
);

80 
sgx_¡©us_t
 
eÿÎ_šü—£_couÁ”
(
sgx_’şave_id_t
 
eid
, 
size_t
* 
»tv®
);

81 
sgx_¡©us_t
 
eÿÎ_´oduûr
(
sgx_’şave_id_t
 
eid
);

82 
sgx_¡©us_t
 
eÿÎ_cÚsum”
(
sgx_’şave_id_t
 
eid
);

84 #ifdeà
__ılu¥lus


	@App/TrustedLibrary/Libc.cpp

26 
	~"../Aµ.h
"

27 
	~"Enşave_u.h
"

32 
	$eÿÎ_libc_funùiÚs
()

34 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

36 
»t
 = 
	`eÿÎ_m®loc_ä“
(
glob®_eid
);

37 ià(
»t
 !ğ
SGX_SUCCESS
)

38 
	`abÜt
();

40 
ıuid
[4] = {0x1, 0x0, 0x0, 0x0};

41 
»t
 = 
	`eÿÎ_sgx_ıuid
(
glob®_eid
, 
ıuid
, 0x0);

42 ià(
»t
 !ğ
SGX_SUCCESS
)

43 
	`abÜt
();

44 
	}
}

	@App/TrustedLibrary/Libcxx.cpp

25 
	~<¡dio.h
>

27 
	~"../Aµ.h
"

28 
	~"Enşave_u.h
"

33 
	$eÿÎ_libcxx_funùiÚs
()

35 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

37 
»t
 = 
	`eÿÎ_exû±iÚ
(
glob®_eid
);

38 ià(
»t
 !ğ
SGX_SUCCESS
)

39 
	`abÜt
();

41 
»t
 = 
	`eÿÎ_m­
(
glob®_eid
);

42 ià(
»t
 !ğ
SGX_SUCCESS
)

43 
	`abÜt
();

44 
	}
}

	@App/TrustedLibrary/Thread.cpp

26 
	~<th»ad
>

27 
	~<¡dio.h
>

28 
usšg
 
Çme¥aû
 
	g¡d
;

30 
	~"../Aµ.h
"

31 
	~"Enşave_u.h
"

33 
size_t
 
	gcouÁ”
 = 0;

35 
	$šü—£_couÁ”
()

37 
size_t
 
úr
 = 0;

38 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

39 
»t
 = 
	`eÿÎ_šü—£_couÁ”
(
glob®_eid
, &
úr
);

40 ià(
úr
 !ğ0è
couÁ”
 = cnr;

41 ià(
»t
 !ğ
SGX_SUCCESS
)

42 
	`abÜt
();

43 
	}
}

45 
	$d©a_´oduûr
()

47 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

48 
»t
 = 
	`eÿÎ_´oduûr
(
glob®_eid
);

49 ià(
»t
 !ğ
SGX_SUCCESS
)

50 
	`abÜt
();

51 
	}
}

53 
	$d©a_cÚsum”
()

55 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

56 
»t
 = 
	`eÿÎ_cÚsum”
(
glob®_eid
);

57 ià(
»t
 !ğ
SGX_SUCCESS
)

58 
	`abÜt
();

59 
	}
}

64 
	$eÿÎ_th»ad_funùiÚs
()

66 
th»ad
 
	`add”1
(
šü—£_couÁ”
);

67 
th»ad
 
	`add”2
(
šü—£_couÁ”
);

68 
th»ad
 
	`add”3
(
šü—£_couÁ”
);

69 
th»ad
 
	`add”4
(
šü—£_couÁ”
);

71 
add”1
.
	`još
();

72 
add”2
.
	`još
();

73 
add”3
.
	`još
();

74 
add”4
.
	`još
();

76 
	`as£¹
(
couÁ”
 =ğ4*
LOOPS_PER_THREAD
);

78 
	`´štf
("Info:ƒxecutinghread synchronization,…lease wait... \n");

80 
th»ad
 
	`cÚsum”1
(
d©a_cÚsum”
);

81 
th»ad
 
	`´oduûr0
(
d©a_´oduûr
);

82 
th»ad
 
	`cÚsum”2
(
d©a_cÚsum”
);

83 
th»ad
 
	`cÚsum”3
(
d©a_cÚsum”
);

84 
th»ad
 
	`cÚsum”4
(
d©a_cÚsum”
);

86 
cÚsum”1
.
	`još
();

87 
cÚsum”2
.
	`još
();

88 
cÚsum”3
.
	`još
();

89 
cÚsum”4
.
	`još
();

90 
´oduûr0
.
	`još
();

91 
	}
}

	@Enclave/Edger8rSyntax/Arrays.cpp

27 
	~"sgx_Œts.h
"

28 
	~"../Enşave.h
"

29 
	~"Enşave_t.h
"

34 
	$eÿÎ_¬¿y_u£r_check
(
¬r
[4])

36 ià(
	`sgx_is_outside_’şave
(
¬r
, 4 * ()) != 1)

37 
	`abÜt
();

39 
i
 = 0; i < 4; i++) {

40 
	`as£¹
(
¬r
[
i
] == i);

41 
¬r
[
i
] = 3 - i;

43 
	}
}

49 
	$eÿÎ_¬¿y_š
(
¬r
[4])

51 
i
 = 0; i < 4; i++) {

52 
	`as£¹
(
¬r
[
i
] == i);

53 
¬r
[
i
] = (3 - i);

55 
	}
}

61 
	$eÿÎ_¬¿y_out
(
¬r
[4])

63 
i
 = 0; i < 4; i++) {

65 
	`as£¹
(
¬r
[
i
] == 0);

66 
¬r
[
i
] = (3 - i);

68 
	}
}

74 
	$eÿÎ_¬¿y_š_out
(
¬r
[4])

76 
i
 = 0; i < 4; i++) {

77 
	`as£¹
(
¬r
[
i
] == i);

78 
¬r
[
i
] = (3 - i);

80 
	}
}

85 
	$eÿÎ_¬¿y_i§ry
(
¬¿y_t
 
¬r
)

87 ià(
	`sgx_is_outside_’şave
(
¬r
, (
¬¿y_t
)) != 1)

88 
	`abÜt
();

90 
n
 = (
¬¿y_t
)/(
¬r
[0]);

91 
i
 = 0; i < 
n
; i++) {

92 
	`as£¹
(
¬r
[
i
] == i);

93 
¬r
[
i
] = (
n
 - 1 - i);

95 
	}
}

	@Enclave/Edger8rSyntax/Functions.cpp

28 
	~<¡ršg.h
>

29 
	~<¡dio.h
>

31 
	~"../Enşave.h
"

32 
	~"Enşave_t.h
"

37 
	$eÿÎ_funùiÚ_ÿÎšg_cÚvs
()

39 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

41 
s1
[] = "1234567890";

42 
s2
[] = "0987654321";

44 
buf
[
BUFSIZ
] = {'\0'};

45 
	`memıy
(
buf
, 
s1
, 
	`¡¾’
(s1));

47 
»t
 = 
	`memcıy
(
NULL
, 
s1
, 
s2
, '\0', 
	`¡¾’
(s1));

49 ià(
»t
 !ğ
SGX_SUCCESS
)

50 
	`abÜt
();

51 
	`as£¹
(
	`memcmp
(
s1
, 
s2
, 
	`¡¾’
(s1)) == 0);

54 
	}
}

59 
	$eÿÎ_funùiÚ_public
()

61 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

63 
»t
 = 
	`oÿÎ_funùiÚ_®low
();

64 ià(
»t
 !ğ
SGX_SUCCESS
)

65 
	`abÜt
();

68 
	}
}

73 
	$eÿÎ_funùiÚ_´iv©e
()

76 
	}
}

	@Enclave/Edger8rSyntax/Pointers.cpp

28 
	~<sys/ty³s.h
>

29 
	~<¡ršg.h
>

31 
	~"sgx_Œts.h
"

32 
	~"../Enşave.h
"

33 
	~"Enşave_t.h
"

38 
št32_t
 
	$checksum_š‹º®
(*
buf
, 
size_t
 
couÁ
)

40 
št32_t
 
sum
 = 0;

41 
št16_t
 *
±r
 = (št16_ˆ*)
buf
;

44 
couÁ
 > 1) {

45 
sum
 = sum + *
±r
++;

46 
couÁ
 = count - 2;

50 ià(
couÁ
 > 0)

51 
sum
 = sum + *((*)
±r
);

53  ~
sum
;

54 
	}
}

59 
size_t
 
	$eÿÎ_poš‹r_u£r_check
(*
v®
, 
size_t
 
sz
)

62 ià(
	`sgx_is_outside_’şave
(
v®
, 
sz
) != 1)

63 
	`abÜt
();

65 
tmp
[100] = {0};

66 
size_t
 
Ën
 = 
sz
>100?100:sz;

70 
	`memıy
(
tmp
, 
v®
, 
Ën
);

72 
št32_t
 
sum
 = 
	`checksum_š‹º®
((*)
tmp
, 
Ën
);

73 
	`´štf
("Checksum(0x%p, %zu) = 0x%x\n",

74 
v®
, 
Ën
, 
sum
);

77 
	`memıy
(
v®
, "SGX_SUCCESS", 
Ën
>12?12:len);

79  
Ën
;

80 
	}
}

86 
	$eÿÎ_poš‹r_š
(*
v®
)

88 ià(
	`sgx_is_w™hš_’şave
(
v®
, ()) != 1)

89 
	`abÜt
();

90 *
v®
 = 1234;

91 
	}
}

96 
	$eÿÎ_poš‹r_out
(*
v®
)

98 ià(
	`sgx_is_w™hš_’şave
(
v®
, ()) != 1)

99 
	`abÜt
();

100 
	`as£¹
(*
v®
 == 0);

101 *
v®
 = 1234;

102 
	}
}

107 
	$eÿÎ_poš‹r_š_out
(*
v®
)

109 ià(
	`sgx_is_w™hš_’şave
(
v®
, ()) != 1)

110 
	`abÜt
();

111 *
v®
 = 1234;

112 
	}
}

117 
	$oÿÎ_poš‹r_©Œ
()

119 
sgx_¡©us_t
 
»t
 = 
SGX_ERROR_UNEXPECTED
;

121 
v®
 = 0;

122 
»t
 = 
	`oÿÎ_poš‹r_u£r_check
(&
v®
);

123 ià(
»t
 !ğ
SGX_SUCCESS
)

124 
	`abÜt
();

126 
v®
 = 0;

127 
»t
 = 
	`oÿÎ_poš‹r_š
(&
v®
);

128 ià(
»t
 !ğ
SGX_SUCCESS
)

129 
	`abÜt
();

130 
	`as£¹
(
v®
 == 0);

132 
v®
 = 0;

133 
»t
 = 
	`oÿÎ_poš‹r_out
(&
v®
);

134 ià(
»t
 !ğ
SGX_SUCCESS
)

135 
	`abÜt
();

136 
	`as£¹
(
v®
 == 1234);

138 
v®
 = 0;

139 
»t
 = 
	`oÿÎ_poš‹r_š_out
(&
v®
);

140 ià(
»t
 !ğ
SGX_SUCCESS
)

141 
	`abÜt
();

142 
	`as£¹
(
v®
 == 1234);

145 
	}
}

150 
	$eÿÎ_poš‹r_¡ršg
(*
¡r
)

152 
	`¡ºıy
(
¡r
, "0987654321", 
	`¡¾’
(str));

153 
	}
}

158 
	$eÿÎ_poš‹r_¡ršg_cÚ¡
(cÚ¡ *
¡r
)

160 * 
‹mp
 = 
Ãw
 [
	`¡¾’
(
¡r
)];

161 
	`¡ºıy
(
‹mp
, 
¡r
, 
	`¡¾’
(str));

162 
d–‘e
 []
‹mp
;

163 
	}
}

168 
	$eÿÎ_poš‹r_size
(*
±r
, 
size_t
 
Ën
)

170 
	`¡ºıy
((*)
±r
, "0987654321", 
Ën
);

171 
	}
}

176 
	$eÿÎ_poš‹r_couÁ
(*
¬r
, 
út
)

178 
i
 = (
út
 - 1); i >= 0; i--)

179 
¬r
[
i
] = (
út
 - 1 - i);

180 
	}
}

186 
	$eÿÎ_poš‹r_i¥Œ_»adÚly
(
bufãr_t
 
buf
, 
size_t
 
Ën
)

188 
	`¡ºıy
((*)
buf
, "0987654321", 
Ën
);

189 
	}
}

194 
size_t
 
	$g‘_bufãr_Ën
(cÚ¡ * 
buf
)

196 ()
buf
;

198 
	}
}

203 
	$eÿÎ_poš‹r_sizefunc
(*
buf
)

205 *
tmp
 = (*)
buf
;

206 
i
 = 0; i < 10; i++) {

207 
	`as£¹
(
tmp
[
i
] == 0);

208 
tmp
[
i
] = i;

210 
	}
}

	@Enclave/Edger8rSyntax/Types.cpp

28 
	~"sgx_Œts.h
"

29 
	~"../Enşave.h
"

30 
	~"Enşave_t.h
"

31 
	~<lim™s
>

32 
	~<cm©h
>

35 
	#UNUSED
(
v®
è()(v®)

	)

37 
	#ULP
 2

	)

40 
boŞ
 
	$®mo¡_equ®
(
x
, 
y
)

44  
¡d
::
	`abs
(
x
-
y
è<ğ¡d::
num”ic_lim™s
<>::
	`•sÚ
(è* std::abs(x+yè* 
ULP
;

45 
	}
}

48 
boŞ
 
	$®mo¡_equ®
(
x
, 
y
)

52  
¡d
::
	`abs
(
x
-
y
è<ğ¡d::
num”ic_lim™s
<>::
	`•sÚ
(è* std::abs(x+yè* 
ULP
;

53 
	}
}

58 
	$eÿÎ_ty³_ch¬
(
v®
)

60 
	`as£¹
(
v®
 == 0x12);

61 #iâdeà
DEBUG


62 
	`UNUSED
(
v®
);

64 
	}
}

69 
	$eÿÎ_ty³_št
(
v®
)

71 
	`as£¹
(
v®
 == 1234);

72 #iâdeà
DEBUG


73 
	`UNUSED
(
v®
);

75 
	}
}

80 
	$eÿÎ_ty³_æßt
(
v®
)

82 
	`as£¹
(
	`®mo¡_equ®
(
v®
, ()1234.0));

83 #iâdeà
DEBUG


84 
	`UNUSED
(
v®
);

86 
	}
}

91 
	$eÿÎ_ty³_doubË
(
v®
)

93 
	`as£¹
(
	`®mo¡_equ®
(
v®
, ()1234.5678));

94 #iâdeà
DEBUG


95 
	`UNUSED
(
v®
);

97 
	}
}

102 
	$eÿÎ_ty³_size_t
(
size_t
 
v®
)

104 
	`as£¹
(
v®
 =ğ(
size_t
)12345678);

105 #iâdeà
DEBUG


106 
	`UNUSED
(
v®
);

108 
	}
}

113 
	$eÿÎ_ty³_wch¬_t
(
wch¬_t
 
v®
)

115 
	`as£¹
(
v®
 =ğ(
wch¬_t
)0x1234);

116 #iâdeà
DEBUG


117 
	`UNUSED
(
v®
);

119 
	}
}

124 
	$eÿÎ_ty³_¡ruù
(
¡ruù_foo_t
 
v®
)

126 
	`as£¹
(
v®
.
¡ruù_foo_0
 == 1234);

127 
	`as£¹
(
v®
.
¡ruù_foo_1
 == 5678);

128 #iâdeà
DEBUG


129 
	`UNUSED
(
v®
);

131 
	}
}

138 
	$eÿÎ_ty³_’um_uniÚ
(
’um_foo_t
 
v®1
, 
uniÚ_foo_t
 *
v®2
)

140 ià(
	`sgx_is_outside_’şave
(
v®2
, (
uniÚ_foo_t
)) != 1)

141 
	`abÜt
();

142 
v®2
->
uniÚ_foo_0
 = 1;

143 
v®2
->
uniÚ_foo_1
 = 2;

144 
	`as£¹
(
v®1
 =ğ
ENUM_FOO_0
);

145 #iâdeà
DEBUG


146 
	`UNUSED
(
v®1
);

148 
	}
}

	@Enclave/Enclave.cpp

26 
	~<¡d¬g.h
>

27 
	~<¡dio.h
>

29 
	~"Enşave.h
"

30 
	~"Enşave_t.h
"

36 
	$´štf
(cÚ¡ *
fmt
, ...)

38 
buf
[
BUFSIZ
] = {'\0'};

39 
va_li¡
 
­
;

40 
	`va_¡¬t
(
­
, 
fmt
);

41 
	`v¢´štf
(
buf
, 
BUFSIZ
, 
fmt
, 
­
);

42 
	`va_’d
(
­
);

43 
	`oÿÎ_´št_¡ršg
(
buf
);

44 
	}
}

46 
	$eÿÎ_maš
()

53 
	`oÿÎ_g’”ic
(100);

57 
	}
}

	@Enclave/Enclave.h

26 #iâdeà
_ENCLAVE_H_


27 
	#_ENCLAVE_H_


	)

29 
	~<¡dlib.h
>

30 
	~<as£¹.h
>

32 #ià
defšed
(
__ılu¥lus
)

36 
´štf
(cÚ¡ *
fmt
, ...);

38 #ià
defšed
(
__ılu¥lus
)

	@Enclave/Enclave_t.c

1 
	~"Enşave_t.h
"

3 
	~"sgx_Œts.h
"

5 
	~<”ºo.h
>

6 
	~<¡ršg.h
>

7 
	~<¡dlib.h
>

9 
	#CHECK_REF_POINTER
(
±r
, 
siz
) do { \

10 ià(!(
±r
è|| ! 
	`sgx_is_outside_’şave
(ÕŒ), (
siz
))) \

11  
SGX_ERROR_INVALID_PARAMETER
;\

12 } 0)

	)

14 
	#CHECK_UNIQUE_POINTER
(
±r
, 
siz
) do { \

15 ià((
±r
è&& ! 
	`sgx_is_outside_’şave
(ÕŒ), (
siz
))) \

16  
SGX_ERROR_INVALID_PARAMETER
;\

17 } 0)

	)

21 
	sms_eÿÎ_ty³_ch¬_t
 {

22 
	mms_v®
;

23 } 
	tms_eÿÎ_ty³_ch¬_t
;

25 
	sms_eÿÎ_ty³_št_t
 {

26 
	mms_v®
;

27 } 
	tms_eÿÎ_ty³_št_t
;

29 
	sms_eÿÎ_ty³_æßt_t
 {

30 
	mms_v®
;

31 } 
	tms_eÿÎ_ty³_æßt_t
;

33 
	sms_eÿÎ_ty³_doubË_t
 {

34 
	mms_v®
;

35 } 
	tms_eÿÎ_ty³_doubË_t
;

37 
	sms_eÿÎ_ty³_size_t_t
 {

38 
size_t
 
	mms_v®
;

39 } 
	tms_eÿÎ_ty³_size_t_t
;

41 
	sms_eÿÎ_ty³_wch¬_t_t
 {

42 
wch¬_t
 
	mms_v®
;

43 } 
	tms_eÿÎ_ty³_wch¬_t_t
;

45 
	sms_eÿÎ_ty³_¡ruù_t
 {

46 
¡ruù_foo_t
 
	mms_v®
;

47 } 
	tms_eÿÎ_ty³_¡ruù_t
;

49 
	sms_eÿÎ_ty³_’um_uniÚ_t
 {

50 
’um_foo_t
 
	mms_v®1
;

51 
uniÚ_foo_t
* 
	mms_v®2
;

52 } 
	tms_eÿÎ_ty³_’um_uniÚ_t
;

54 
	sms_eÿÎ_poš‹r_u£r_check_t
 {

55 
size_t
 
	mms_»tv®
;

56 * 
	mms_v®
;

57 
size_t
 
	mms_sz
;

58 } 
	tms_eÿÎ_poš‹r_u£r_check_t
;

60 
	sms_eÿÎ_poš‹r_š_t
 {

61 * 
	mms_v®
;

62 } 
	tms_eÿÎ_poš‹r_š_t
;

64 
	sms_eÿÎ_poš‹r_out_t
 {

65 * 
	mms_v®
;

66 } 
	tms_eÿÎ_poš‹r_out_t
;

68 
	sms_eÿÎ_poš‹r_š_out_t
 {

69 * 
	mms_v®
;

70 } 
	tms_eÿÎ_poš‹r_š_out_t
;

72 
	sms_eÿÎ_poš‹r_¡ršg_t
 {

73 * 
	mms_¡r
;

74 } 
	tms_eÿÎ_poš‹r_¡ršg_t
;

76 
	sms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
 {

77 * 
	mms_¡r
;

78 } 
	tms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
;

80 
	sms_eÿÎ_poš‹r_size_t
 {

81 * 
	mms_±r
;

82 
size_t
 
	mms_Ën
;

83 } 
	tms_eÿÎ_poš‹r_size_t
;

85 
	sms_eÿÎ_poš‹r_couÁ_t
 {

86 * 
	mms_¬r
;

87 
	mms_út
;

88 } 
	tms_eÿÎ_poš‹r_couÁ_t
;

90 
	sms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
 {

91 
bufãr_t
 
	mms_buf
;

92 
size_t
 
	mms_Ën
;

93 } 
	tms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
;

95 
	sms_eÿÎ_poš‹r_sizefunc_t
 {

96 * 
	mms_buf
;

97 } 
	tms_eÿÎ_poš‹r_sizefunc_t
;

100 
	sms_eÿÎ_¬¿y_u£r_check_t
 {

101 * 
	mms_¬r
;

102 } 
	tms_eÿÎ_¬¿y_u£r_check_t
;

104 
	sms_eÿÎ_¬¿y_š_t
 {

105 * 
	mms_¬r
;

106 } 
	tms_eÿÎ_¬¿y_š_t
;

108 
	sms_eÿÎ_¬¿y_out_t
 {

109 * 
	mms_¬r
;

110 } 
	tms_eÿÎ_¬¿y_out_t
;

112 
	sms_eÿÎ_¬¿y_š_out_t
 {

113 * 
	mms_¬r
;

114 } 
	tms_eÿÎ_¬¿y_š_out_t
;

116 
	sms_eÿÎ_¬¿y_i§ry_t
 {

117 
¬¿y_t
* 
	mms_¬r
;

118 } 
	tms_eÿÎ_¬¿y_i§ry_t
;

122 
	sms_eÿÎ_funùiÚ_´iv©e_t
 {

123 
	mms_»tv®
;

124 } 
	tms_eÿÎ_funùiÚ_´iv©e_t
;

127 
	sms_eÿÎ_sgx_ıuid_t
 {

128 * 
	mms_ıušfo
;

129 
	mms_Ëaf
;

130 } 
	tms_eÿÎ_sgx_ıuid_t
;

134 
	sms_eÿÎ_šü—£_couÁ”_t
 {

135 
size_t
 
	mms_»tv®
;

136 } 
	tms_eÿÎ_šü—£_couÁ”_t
;

140 
	sms_oÿÎ_´št_¡ršg_t
 {

141 * 
	mms_¡r
;

142 } 
	tms_oÿÎ_´št_¡ršg_t
;

144 
	sms_oÿÎ_g’”ic_t
 {

145 
	mms_»tv®
;

146 
	mms_±r
;

147 } 
	tms_oÿÎ_g’”ic_t
;

149 
	sms_oÿÎ_poš‹r_u£r_check_t
 {

150 * 
	mms_v®
;

151 } 
	tms_oÿÎ_poš‹r_u£r_check_t
;

153 
	sms_oÿÎ_poš‹r_š_t
 {

154 * 
	mms_v®
;

155 } 
	tms_oÿÎ_poš‹r_š_t
;

157 
	sms_oÿÎ_poš‹r_out_t
 {

158 * 
	mms_v®
;

159 } 
	tms_oÿÎ_poš‹r_out_t
;

161 
	sms_oÿÎ_poš‹r_š_out_t
 {

162 * 
	mms_v®
;

163 } 
	tms_oÿÎ_poš‹r_š_out_t
;

165 
	sms_memcıy_t
 {

166 * 
	mms_»tv®
;

167 * 
	mms_de¡
;

168 * 
	mms_¤c
;

169 
	mms_v®
;

170 
size_t
 
	mms_Ën
;

171 } 
	tms_memcıy_t
;

174 
	sms_sgx_oc_ıuidex_t
 {

175 * 
	mms_ıušfo
;

176 
	mms_Ëaf
;

177 
	mms_subËaf
;

178 } 
	tms_sgx_oc_ıuidex_t
;

180 
	sms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
 {

181 
	mms_»tv®
;

182 * 
	mms_£lf
;

183 } 
	tms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
;

185 
	sms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
 {

186 
	mms_»tv®
;

187 * 
	mms_wa™”
;

188 } 
	tms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
;

190 
	sms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
 {

191 
	mms_»tv®
;

192 * 
	mms_wa™”
;

193 * 
	mms_£lf
;

194 } 
	tms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
;

196 
	sms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
 {

197 
	mms_»tv®
;

198 ** 
	mms_wa™”s
;

199 
size_t
 
	mms_tÙ®
;

200 } 
	tms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
;

202 #ifdeà
_MSC_VER


203 #´agm¨
w¬nšg
(
push
)

204 #´agm¨
w¬nšg
(
di§bË
: 4127)

205 #´agm¨
w¬nšg
(
di§bË
: 4200)

208 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_maš
(* 
pms
)

210 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

211 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

212 
	`eÿÎ_maš
();

213  
¡©us
;

214 
	}
}

216 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_ch¬
(* 
pms
)

218 
ms_eÿÎ_ty³_ch¬_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_ch¬_t*, 
pms
);

219 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

221 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_ch¬_t
));

223 
	`eÿÎ_ty³_ch¬
(
ms
->
ms_v®
);

226  
¡©us
;

227 
	}
}

229 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_št
(* 
pms
)

231 
ms_eÿÎ_ty³_št_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_št_t*, 
pms
);

232 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

234 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_št_t
));

236 
	`eÿÎ_ty³_št
(
ms
->
ms_v®
);

239  
¡©us
;

240 
	}
}

242 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_æßt
(* 
pms
)

244 
ms_eÿÎ_ty³_æßt_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_æßt_t*, 
pms
);

245 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

247 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_æßt_t
));

249 
	`eÿÎ_ty³_æßt
(
ms
->
ms_v®
);

252  
¡©us
;

253 
	}
}

255 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_doubË
(* 
pms
)

257 
ms_eÿÎ_ty³_doubË_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_doubË_t*, 
pms
);

258 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

260 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_doubË_t
));

262 
	`eÿÎ_ty³_doubË
(
ms
->
ms_v®
);

265  
¡©us
;

266 
	}
}

268 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_size_t
(* 
pms
)

270 
ms_eÿÎ_ty³_size_t_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_size_t_t*, 
pms
);

271 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

273 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_size_t_t
));

275 
	`eÿÎ_ty³_size_t
(
ms
->
ms_v®
);

278  
¡©us
;

279 
	}
}

281 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_wch¬_t
(* 
pms
)

283 
ms_eÿÎ_ty³_wch¬_t_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_wch¬_t_t*, 
pms
);

284 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

286 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_wch¬_t_t
));

288 
	`eÿÎ_ty³_wch¬_t
(
ms
->
ms_v®
);

291  
¡©us
;

292 
	}
}

294 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_¡ruù
(* 
pms
)

296 
ms_eÿÎ_ty³_¡ruù_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_¡ruù_t*, 
pms
);

297 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

299 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_¡ruù_t
));

301 
	`eÿÎ_ty³_¡ruù
(
ms
->
ms_v®
);

304  
¡©us
;

305 
	}
}

307 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_ty³_’um_uniÚ
(* 
pms
)

309 
ms_eÿÎ_ty³_’um_uniÚ_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_ty³_’um_uniÚ_t*, 
pms
);

310 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

311 
uniÚ_foo_t
* 
_tmp_v®2
 = 
ms
->
ms_v®2
;

313 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_ty³_’um_uniÚ_t
));

315 
	`eÿÎ_ty³_’um_uniÚ
(
ms
->
ms_v®1
, 
_tmp_v®2
);

318  
¡©us
;

319 
	}
}

321 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_u£r_check
(* 
pms
)

323 
ms_eÿÎ_poš‹r_u£r_check_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_u£r_check_t*, 
pms
);

324 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

325 * 
_tmp_v®
 = 
ms
->
ms_v®
;

327 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_u£r_check_t
));

329 
ms
->
ms_»tv®
 = 
	`eÿÎ_poš‹r_u£r_check
(
_tmp_v®
, ms->
ms_sz
);

332  
¡©us
;

333 
	}
}

335 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_š
(* 
pms
)

337 
ms_eÿÎ_poš‹r_š_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_š_t*, 
pms
);

338 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

339 * 
_tmp_v®
 = 
ms
->
ms_v®
;

340 
size_t
 
_Ën_v®
 = (*
_tmp_v®
);

341 * 
_š_v®
 = 
NULL
;

343 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_š_t
));

344 
	`CHECK_UNIQUE_POINTER
(
_tmp_v®
, 
_Ën_v®
);

346 ià(
_tmp_v®
 !ğ
NULL
) {

347 
_š_v®
 = (*)
	`m®loc
(
_Ën_v®
);

348 ià(
_š_v®
 =ğ
NULL
) {

349 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

350 
”r
;

353 
	`memıy
(
_š_v®
, 
_tmp_v®
, 
_Ën_v®
);

355 
	`eÿÎ_poš‹r_š
(
_š_v®
);

356 
”r
:

357 ià(
_š_v®
è
	`ä“
(_in_val);

359  
¡©us
;

360 
	}
}

362 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_out
(* 
pms
)

364 
ms_eÿÎ_poš‹r_out_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_out_t*, 
pms
);

365 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

366 * 
_tmp_v®
 = 
ms
->
ms_v®
;

367 
size_t
 
_Ën_v®
 = (*
_tmp_v®
);

368 * 
_š_v®
 = 
NULL
;

370 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_out_t
));

371 
	`CHECK_UNIQUE_POINTER
(
_tmp_v®
, 
_Ën_v®
);

373 ià(
_tmp_v®
 !ğ
NULL
) {

374 ià((
_š_v®
 = (*)
	`m®loc
(
_Ën_v®
)è=ğ
NULL
) {

375 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

376 
”r
;

379 
	`mem£t
((*)
_š_v®
, 0, 
_Ën_v®
);

381 
	`eÿÎ_poš‹r_out
(
_š_v®
);

382 
”r
:

383 ià(
_š_v®
) {

384 
	`memıy
(
_tmp_v®
, 
_š_v®
, 
_Ën_v®
);

385 
	`ä“
(
_š_v®
);

388  
¡©us
;

389 
	}
}

391 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_š_out
(* 
pms
)

393 
ms_eÿÎ_poš‹r_š_out_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_š_out_t*, 
pms
);

394 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

395 * 
_tmp_v®
 = 
ms
->
ms_v®
;

396 
size_t
 
_Ën_v®
 = (*
_tmp_v®
);

397 * 
_š_v®
 = 
NULL
;

399 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_š_out_t
));

400 
	`CHECK_UNIQUE_POINTER
(
_tmp_v®
, 
_Ën_v®
);

402 ià(
_tmp_v®
 !ğ
NULL
) {

403 
_š_v®
 = (*)
	`m®loc
(
_Ën_v®
);

404 ià(
_š_v®
 =ğ
NULL
) {

405 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

406 
”r
;

409 
	`memıy
(
_š_v®
, 
_tmp_v®
, 
_Ën_v®
);

411 
	`eÿÎ_poš‹r_š_out
(
_š_v®
);

412 
”r
:

413 ià(
_š_v®
) {

414 
	`memıy
(
_tmp_v®
, 
_š_v®
, 
_Ën_v®
);

415 
	`ä“
(
_š_v®
);

418  
¡©us
;

419 
	}
}

421 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_¡ršg
(* 
pms
)

423 
ms_eÿÎ_poš‹r_¡ršg_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_¡ršg_t*, 
pms
);

424 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

425 * 
_tmp_¡r
 = 
ms
->
ms_¡r
;

426 
size_t
 
_Ën_¡r
 = 
_tmp_¡r
 ? 
	`¡¾’
(_tmp_str) + 1 : 0;

427 * 
_š_¡r
 = 
NULL
;

429 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_¡ršg_t
));

430 
	`CHECK_UNIQUE_POINTER
(
_tmp_¡r
, 
_Ën_¡r
);

432 ià(
_tmp_¡r
 !ğ
NULL
) {

433 
_š_¡r
 = (*)
	`m®loc
(
_Ën_¡r
);

434 ià(
_š_¡r
 =ğ
NULL
) {

435 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

436 
”r
;

439 
	`memıy
(
_š_¡r
, 
_tmp_¡r
, 
_Ën_¡r
);

440 
_š_¡r
[
_Ën_¡r
 - 1] = '\0';

442 
	`eÿÎ_poš‹r_¡ršg
(
_š_¡r
);

443 
”r
:

444 ià(
_š_¡r
) {

445 
	`memıy
(
_tmp_¡r
, 
_š_¡r
, 
_Ën_¡r
);

446 
	`ä“
(
_š_¡r
);

449  
¡©us
;

450 
	}
}

452 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_¡ršg_cÚ¡
(* 
pms
)

454 
ms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_¡ršg_cÚ¡_t*, 
pms
);

455 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

456 * 
_tmp_¡r
 = 
ms
->
ms_¡r
;

457 
size_t
 
_Ën_¡r
 = 
_tmp_¡r
 ? 
	`¡¾’
(_tmp_str) + 1 : 0;

458 * 
_š_¡r
 = 
NULL
;

460 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_¡ršg_cÚ¡_t
));

461 
	`CHECK_UNIQUE_POINTER
(
_tmp_¡r
, 
_Ën_¡r
);

463 ià(
_tmp_¡r
 !ğ
NULL
) {

464 
_š_¡r
 = (*)
	`m®loc
(
_Ën_¡r
);

465 ià(
_š_¡r
 =ğ
NULL
) {

466 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

467 
”r
;

470 
	`memıy
((*)
_š_¡r
, 
_tmp_¡r
, 
_Ën_¡r
);

471 
_š_¡r
[
_Ën_¡r
 - 1] = '\0';

473 
	`eÿÎ_poš‹r_¡ršg_cÚ¡
((cÚ¡ *)
_š_¡r
);

474 
”r
:

475 ià(
_š_¡r
è
	`ä“
((*)_in_str);

477  
¡©us
;

478 
	}
}

480 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_size
(* 
pms
)

482 
ms_eÿÎ_poš‹r_size_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_size_t*, 
pms
);

483 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

484 * 
_tmp_±r
 = 
ms
->
ms_±r
;

485 
size_t
 
_tmp_Ën
 = 
ms
->
ms_Ën
;

486 
size_t
 
_Ën_±r
 = 
_tmp_Ën
;

487 * 
_š_±r
 = 
NULL
;

489 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_size_t
));

490 
	`CHECK_UNIQUE_POINTER
(
_tmp_±r
, 
_Ën_±r
);

492 ià(
_tmp_±r
 !ğ
NULL
) {

493 
_š_±r
 = (*)
	`m®loc
(
_Ën_±r
);

494 ià(
_š_±r
 =ğ
NULL
) {

495 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

496 
”r
;

499 
	`memıy
(
_š_±r
, 
_tmp_±r
, 
_Ën_±r
);

501 
	`eÿÎ_poš‹r_size
(
_š_±r
, 
_tmp_Ën
);

502 
”r
:

503 ià(
_š_±r
) {

504 
	`memıy
(
_tmp_±r
, 
_š_±r
, 
_Ën_±r
);

505 
	`ä“
(
_š_±r
);

508  
¡©us
;

509 
	}
}

511 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_couÁ
(* 
pms
)

513 
ms_eÿÎ_poš‹r_couÁ_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_couÁ_t*, 
pms
);

514 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

515 * 
_tmp_¬r
 = 
ms
->
ms_¬r
;

516 
_tmp_út
 = 
ms
->
ms_út
;

517 
size_t
 
_Ën_¬r
 = 
_tmp_út
 * (*
_tmp_¬r
);

518 * 
_š_¬r
 = 
NULL
;

520 ià((
size_t
)
_tmp_út
 > (
SIZE_MAX
 / (*
_tmp_¬r
))) {

521 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

522 
”r
;

525 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_couÁ_t
));

526 
	`CHECK_UNIQUE_POINTER
(
_tmp_¬r
, 
_Ën_¬r
);

528 ià(
_tmp_¬r
 !ğ
NULL
) {

529 
_š_¬r
 = (*)
	`m®loc
(
_Ën_¬r
);

530 ià(
_š_¬r
 =ğ
NULL
) {

531 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

532 
”r
;

535 
	`memıy
(
_š_¬r
, 
_tmp_¬r
, 
_Ën_¬r
);

537 
	`eÿÎ_poš‹r_couÁ
(
_š_¬r
, 
_tmp_út
);

538 
”r
:

539 ià(
_š_¬r
) {

540 
	`memıy
(
_tmp_¬r
, 
_š_¬r
, 
_Ën_¬r
);

541 
	`ä“
(
_š_¬r
);

544  
¡©us
;

545 
	}
}

547 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_i¥Œ_»adÚly
(* 
pms
)

549 
ms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_i¥Œ_»adÚly_t*, 
pms
);

550 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

551 
bufãr_t
 
_tmp_buf
 = 
ms
->
ms_buf
;

552 
size_t
 
_tmp_Ën
 = 
ms
->
ms_Ën
;

553 
size_t
 
_Ën_buf
 = 
_tmp_Ën
;

554 
bufãr_t
 
_š_buf
 = 
NULL
;

556 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_i¥Œ_»adÚly_t
));

557 
	`CHECK_UNIQUE_POINTER
(
_tmp_buf
, 
_Ën_buf
);

559 ià(
_tmp_buf
 !ğ
NULL
) {

560 
_š_buf
 = (
bufãr_t
)
	`m®loc
(
_Ën_buf
);

561 ià(
_š_buf
 =ğ
NULL
) {

562 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

563 
”r
;

566 
	`memıy
((*)
_š_buf
, 
_tmp_buf
, 
_Ën_buf
);

568 
	`eÿÎ_poš‹r_i¥Œ_»adÚly
(
_š_buf
, 
_tmp_Ën
);

569 
”r
:

570 ià(
_š_buf
è
	`ä“
((*)_in_buf);

572  
¡©us
;

573 
	}
}

575 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_poš‹r_sizefunc
(* 
pms
)

577 
ms_eÿÎ_poš‹r_sizefunc_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_poš‹r_sizefunc_t*, 
pms
);

578 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

579 * 
_tmp_buf
 = 
ms
->
ms_buf
;

580 
size_t
 
_Ën_buf
 = ((
_tmp_buf
è? 
	`g‘_bufãr_Ën
(_tmp_buf) : 0);

581 * 
_š_buf
 = 
NULL
;

583 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_poš‹r_sizefunc_t
));

584 
	`CHECK_UNIQUE_POINTER
(
_tmp_buf
, 
_Ën_buf
);

586 ià(
_tmp_buf
 !ğ
NULL
) {

587 
_š_buf
 = (*)
	`m®loc
(
_Ën_buf
);

588 ià(
_š_buf
 =ğ
NULL
) {

589 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

590 
”r
;

593 
	`memıy
(
_š_buf
, 
_tmp_buf
, 
_Ën_buf
);

596 ià(
	`g‘_bufãr_Ën
(
_š_buf
è!ğ
_Ën_buf
) {

597 
¡©us
 = 
SGX_ERROR_INVALID_PARAMETER
;

598 
”r
;

601 
	`eÿÎ_poš‹r_sizefunc
(
_š_buf
);

602 
”r
:

603 ià(
_š_buf
) {

604 
	`memıy
(
_tmp_buf
, 
_š_buf
, 
_Ën_buf
);

605 
	`ä“
(
_š_buf
);

608  
¡©us
;

609 
	}
}

611 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_oÿÎ_poš‹r_©Œ
(* 
pms
)

613 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

614 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

615 
	`oÿÎ_poš‹r_©Œ
();

616  
¡©us
;

617 
	}
}

619 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_¬¿y_u£r_check
(* 
pms
)

621 
ms_eÿÎ_¬¿y_u£r_check_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_¬¿y_u£r_check_t*, 
pms
);

622 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

623 * 
_tmp_¬r
 = 
ms
->
ms_¬r
;

625 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_¬¿y_u£r_check_t
));

627 
	`eÿÎ_¬¿y_u£r_check
(
_tmp_¬r
);

630  
¡©us
;

631 
	}
}

633 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_¬¿y_š
(* 
pms
)

635 
ms_eÿÎ_¬¿y_š_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_¬¿y_š_t*, 
pms
);

636 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

637 * 
_tmp_¬r
 = 
ms
->
ms_¬r
;

638 
size_t
 
_Ën_¬r
 = 4 * (*
_tmp_¬r
);

639 * 
_š_¬r
 = 
NULL
;

641 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_¬¿y_š_t
));

642 
	`CHECK_UNIQUE_POINTER
(
_tmp_¬r
, 
_Ën_¬r
);

644 ià(
_tmp_¬r
 !ğ
NULL
) {

645 
_š_¬r
 = (*)
	`m®loc
(
_Ën_¬r
);

646 ià(
_š_¬r
 =ğ
NULL
) {

647 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

648 
”r
;

651 
	`memıy
(
_š_¬r
, 
_tmp_¬r
, 
_Ën_¬r
);

653 
	`eÿÎ_¬¿y_š
(
_š_¬r
);

654 
”r
:

655 ià(
_š_¬r
è
	`ä“
(_in_arr);

657  
¡©us
;

658 
	}
}

660 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_¬¿y_out
(* 
pms
)

662 
ms_eÿÎ_¬¿y_out_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_¬¿y_out_t*, 
pms
);

663 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

664 * 
_tmp_¬r
 = 
ms
->
ms_¬r
;

665 
size_t
 
_Ën_¬r
 = 4 * (*
_tmp_¬r
);

666 * 
_š_¬r
 = 
NULL
;

668 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_¬¿y_out_t
));

669 
	`CHECK_UNIQUE_POINTER
(
_tmp_¬r
, 
_Ën_¬r
);

671 ià(
_tmp_¬r
 !ğ
NULL
) {

672 ià((
_š_¬r
 = (*)
	`m®loc
(
_Ën_¬r
)è=ğ
NULL
) {

673 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

674 
”r
;

677 
	`mem£t
((*)
_š_¬r
, 0, 
_Ën_¬r
);

679 
	`eÿÎ_¬¿y_out
(
_š_¬r
);

680 
”r
:

681 ià(
_š_¬r
) {

682 
	`memıy
(
_tmp_¬r
, 
_š_¬r
, 
_Ën_¬r
);

683 
	`ä“
(
_š_¬r
);

686  
¡©us
;

687 
	}
}

689 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_¬¿y_š_out
(* 
pms
)

691 
ms_eÿÎ_¬¿y_š_out_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_¬¿y_š_out_t*, 
pms
);

692 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

693 * 
_tmp_¬r
 = 
ms
->
ms_¬r
;

694 
size_t
 
_Ën_¬r
 = 4 * (*
_tmp_¬r
);

695 * 
_š_¬r
 = 
NULL
;

697 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_¬¿y_š_out_t
));

698 
	`CHECK_UNIQUE_POINTER
(
_tmp_¬r
, 
_Ën_¬r
);

700 ià(
_tmp_¬r
 !ğ
NULL
) {

701 
_š_¬r
 = (*)
	`m®loc
(
_Ën_¬r
);

702 ià(
_š_¬r
 =ğ
NULL
) {

703 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

704 
”r
;

707 
	`memıy
(
_š_¬r
, 
_tmp_¬r
, 
_Ën_¬r
);

709 
	`eÿÎ_¬¿y_š_out
(
_š_¬r
);

710 
”r
:

711 ià(
_š_¬r
) {

712 
	`memıy
(
_tmp_¬r
, 
_š_¬r
, 
_Ën_¬r
);

713 
	`ä“
(
_š_¬r
);

716  
¡©us
;

717 
	}
}

719 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_¬¿y_i§ry
(* 
pms
)

721 
ms_eÿÎ_¬¿y_i§ry_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_¬¿y_i§ry_t*, 
pms
);

722 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

724 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_¬¿y_i§ry_t
));

726 
	`eÿÎ_¬¿y_i§ry
((
ms
->
ms_¬r
 !ğ
NULL
) ? (*ms->ms_arr) : NULL);

729  
¡©us
;

730 
	}
}

732 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_funùiÚ_ÿÎšg_cÚvs
(* 
pms
)

734 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

735 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

736 
	`eÿÎ_funùiÚ_ÿÎšg_cÚvs
();

737  
¡©us
;

738 
	}
}

740 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_funùiÚ_public
(* 
pms
)

742 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

743 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

744 
	`eÿÎ_funùiÚ_public
();

745  
¡©us
;

746 
	}
}

748 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_funùiÚ_´iv©e
(* 
pms
)

750 
ms_eÿÎ_funùiÚ_´iv©e_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_funùiÚ_´iv©e_t*, 
pms
);

751 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

753 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_funùiÚ_´iv©e_t
));

755 
ms
->
ms_»tv®
 = 
	`eÿÎ_funùiÚ_´iv©e
();

758  
¡©us
;

759 
	}
}

761 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_m®loc_ä“
(* 
pms
)

763 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

764 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

765 
	`eÿÎ_m®loc_ä“
();

766  
¡©us
;

767 
	}
}

769 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_sgx_ıuid
(* 
pms
)

771 
ms_eÿÎ_sgx_ıuid_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_sgx_ıuid_t*, 
pms
);

772 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

773 * 
_tmp_ıušfo
 = 
ms
->
ms_ıušfo
;

774 
size_t
 
_Ën_ıušfo
 = 4 * (*
_tmp_ıušfo
);

775 * 
_š_ıušfo
 = 
NULL
;

777 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_sgx_ıuid_t
));

778 
	`CHECK_UNIQUE_POINTER
(
_tmp_ıušfo
, 
_Ën_ıušfo
);

780 ià(
_tmp_ıušfo
 !ğ
NULL
) {

781 
_š_ıušfo
 = (*)
	`m®loc
(
_Ën_ıušfo
);

782 ià(
_š_ıušfo
 =ğ
NULL
) {

783 
¡©us
 = 
SGX_ERROR_OUT_OF_MEMORY
;

784 
”r
;

787 
	`memıy
(
_š_ıušfo
, 
_tmp_ıušfo
, 
_Ën_ıušfo
);

789 
	`eÿÎ_sgx_ıuid
(
_š_ıušfo
, 
ms
->
ms_Ëaf
);

790 
”r
:

791 ià(
_š_ıušfo
) {

792 
	`memıy
(
_tmp_ıušfo
, 
_š_ıušfo
, 
_Ën_ıušfo
);

793 
	`ä“
(
_š_ıušfo
);

796  
¡©us
;

797 
	}
}

799 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_exû±iÚ
(* 
pms
)

801 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

802 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

803 
	`eÿÎ_exû±iÚ
();

804  
¡©us
;

805 
	}
}

807 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_m­
(* 
pms
)

809 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

810 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

811 
	`eÿÎ_m­
();

812  
¡©us
;

813 
	}
}

815 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_šü—£_couÁ”
(* 
pms
)

817 
ms_eÿÎ_šü—£_couÁ”_t
* 
ms
 = 
	`SGX_CAST
(ms_eÿÎ_šü—£_couÁ”_t*, 
pms
);

818 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

820 
	`CHECK_REF_POINTER
(
pms
, (
ms_eÿÎ_šü—£_couÁ”_t
));

822 
ms
->
ms_»tv®
 = 
	`eÿÎ_šü—£_couÁ”
();

825  
¡©us
;

826 
	}
}

828 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_´oduûr
(* 
pms
)

830 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

831 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

832 
	`eÿÎ_´oduûr
();

833  
¡©us
;

834 
	}
}

836 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_eÿÎ_cÚsum”
(* 
pms
)

838 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

839 ià(
pms
 !ğ
NULL
è 
SGX_ERROR_INVALID_PARAMETER
;

840 
	`eÿÎ_cÚsum”
();

841  
¡©us
;

842 
	}
}

844 
SGX_EXTERNC
 const struct {

845 
size_t
 
	mÄ_eÿÎ
;

846 ¡ruù {* 
	mÿÎ_addr
; 
ušt8_t
 
	mis_´iv
;} 
	meÿÎ_bË
[35];

847 } 
	gg_eÿÎ_bË
 = {

850 {(*)(
ušŒ_t
)
sgx_eÿÎ_maš
, 0},

851 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_ch¬
, 0},

852 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_št
, 0},

853 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_æßt
, 0},

854 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_doubË
, 0},

855 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_size_t
, 0},

856 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_wch¬_t
, 0},

857 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_¡ruù
, 0},

858 {(*)(
ušŒ_t
)
sgx_eÿÎ_ty³_’um_uniÚ
, 0},

859 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_u£r_check
, 0},

860 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_š
, 0},

861 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_out
, 0},

862 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_š_out
, 0},

863 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_¡ršg
, 0},

864 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_¡ršg_cÚ¡
, 0},

865 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_size
, 0},

866 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_couÁ
, 0},

867 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_i¥Œ_»adÚly
, 0},

868 {(*)(
ušŒ_t
)
sgx_eÿÎ_poš‹r_sizefunc
, 0},

869 {(*)(
ušŒ_t
)
sgx_oÿÎ_poš‹r_©Œ
, 0},

870 {(*)(
ušŒ_t
)
sgx_eÿÎ_¬¿y_u£r_check
, 0},

871 {(*)(
ušŒ_t
)
sgx_eÿÎ_¬¿y_š
, 0},

872 {(*)(
ušŒ_t
)
sgx_eÿÎ_¬¿y_out
, 0},

873 {(*)(
ušŒ_t
)
sgx_eÿÎ_¬¿y_š_out
, 0},

874 {(*)(
ušŒ_t
)
sgx_eÿÎ_¬¿y_i§ry
, 0},

875 {(*)(
ušŒ_t
)
sgx_eÿÎ_funùiÚ_ÿÎšg_cÚvs
, 0},

876 {(*)(
ušŒ_t
)
sgx_eÿÎ_funùiÚ_public
, 0},

877 {(*)(
ušŒ_t
)
sgx_eÿÎ_funùiÚ_´iv©e
, 1},

878 {(*)(
ušŒ_t
)
sgx_eÿÎ_m®loc_ä“
, 0},

879 {(*)(
ušŒ_t
)
sgx_eÿÎ_sgx_ıuid
, 0},

880 {(*)(
ušŒ_t
)
sgx_eÿÎ_exû±iÚ
, 0},

881 {(*)(
ušŒ_t
)
sgx_eÿÎ_m­
, 0},

882 {(*)(
ušŒ_t
)
sgx_eÿÎ_šü—£_couÁ”
, 0},

883 {(*)(
ušŒ_t
)
sgx_eÿÎ_´oduûr
, 0},

884 {(*)(
ušŒ_t
)
sgx_eÿÎ_cÚsum”
, 0},

888 
SGX_EXTERNC
 const struct {

889 
size_t
 
	mÄ_oÿÎ
;

890 
ušt8_t
 
	m’Œy_bË
[13][35];

891 } 
	gg_dyn_’Œy_bË
 = {

911 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_´št_¡ršg
(cÚ¡ * 
¡r
)

913 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

914 
size_t
 
_Ën_¡r
 = 
¡r
 ? 
	`¡¾’
(str) + 1 : 0;

916 
ms_oÿÎ_´št_¡ršg_t
* 
ms
 = 
NULL
;

917 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_´št_¡ršg_t
);

918 *
__tmp
 = 
NULL
;

920 
oÿÎoc_size
 +ğ(
¡r
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(¡r, 
_Ën_¡r
)) ? _len_str : 0;

922 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

923 ià(
__tmp
 =ğ
NULL
) {

924 
	`sgx_ocä“
();

925  
SGX_ERROR_UNEXPECTED
;

927 
ms
 = (
ms_oÿÎ_´št_¡ršg_t
*)
__tmp
;

928 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_´št_¡ršg_t
));

930 ià(
¡r
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(¡r, 
_Ën_¡r
)) {

931 
ms
->
ms_¡r
 = (*)
__tmp
;

932 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_¡r
);

933 
	`memıy
((*)
ms
->
ms_¡r
, 
¡r
, 
_Ën_¡r
);

934 } ià(
¡r
 =ğ
NULL
) {

935 
ms
->
ms_¡r
 = 
NULL
;

937 
	`sgx_ocä“
();

938  
SGX_ERROR_INVALID_PARAMETER
;

941 
¡©us
 = 
	`sgx_oÿÎ
(0, 
ms
);

944 
	`sgx_ocä“
();

945  
¡©us
;

946 
	}
}

948 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_g’”ic
(* 
»tv®
, 
±r
)

950 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

952 
ms_oÿÎ_g’”ic_t
* 
ms
 = 
NULL
;

953 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_g’”ic_t
);

954 *
__tmp
 = 
NULL
;

957 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

958 ià(
__tmp
 =ğ
NULL
) {

959 
	`sgx_ocä“
();

960  
SGX_ERROR_UNEXPECTED
;

962 
ms
 = (
ms_oÿÎ_g’”ic_t
*)
__tmp
;

963 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_g’”ic_t
));

965 
ms
->
ms_±r
 = 
±r
;

966 
¡©us
 = 
	`sgx_oÿÎ
(1, 
ms
);

968 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

970 
	`sgx_ocä“
();

971  
¡©us
;

972 
	}
}

974 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_poš‹r_u£r_check
(* 
v®
)

976 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

978 
ms_oÿÎ_poš‹r_u£r_check_t
* 
ms
 = 
NULL
;

979 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_poš‹r_u£r_check_t
);

980 *
__tmp
 = 
NULL
;

983 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

984 ià(
__tmp
 =ğ
NULL
) {

985 
	`sgx_ocä“
();

986  
SGX_ERROR_UNEXPECTED
;

988 
ms
 = (
ms_oÿÎ_poš‹r_u£r_check_t
*)
__tmp
;

989 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_poš‹r_u£r_check_t
));

991 
ms
->
ms_v®
 = 
	`SGX_CAST
(*, 
v®
);

992 
¡©us
 = 
	`sgx_oÿÎ
(2, 
ms
);

995 
	`sgx_ocä“
();

996  
¡©us
;

997 
	}
}

999 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_poš‹r_š
(* 
v®
)

1001 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1002 
size_t
 
_Ën_v®
 = (*
v®
);

1004 
ms_oÿÎ_poš‹r_š_t
* 
ms
 = 
NULL
;

1005 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_poš‹r_š_t
);

1006 *
__tmp
 = 
NULL
;

1008 
oÿÎoc_size
 +ğ(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) ? _len_val : 0;

1010 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1011 ià(
__tmp
 =ğ
NULL
) {

1012 
	`sgx_ocä“
();

1013  
SGX_ERROR_UNEXPECTED
;

1015 
ms
 = (
ms_oÿÎ_poš‹r_š_t
*)
__tmp
;

1016 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_poš‹r_š_t
));

1018 ià(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) {

1019 
ms
->
ms_v®
 = (*)
__tmp
;

1020 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_v®
);

1021 
	`memıy
(
ms
->
ms_v®
, 
v®
, 
_Ën_v®
);

1022 } ià(
v®
 =ğ
NULL
) {

1023 
ms
->
ms_v®
 = 
NULL
;

1025 
	`sgx_ocä“
();

1026  
SGX_ERROR_INVALID_PARAMETER
;

1029 
¡©us
 = 
	`sgx_oÿÎ
(3, 
ms
);

1032 
	`sgx_ocä“
();

1033  
¡©us
;

1034 
	}
}

1036 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_poš‹r_out
(* 
v®
)

1038 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1039 
size_t
 
_Ën_v®
 = (*
v®
);

1041 
ms_oÿÎ_poš‹r_out_t
* 
ms
 = 
NULL
;

1042 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_poš‹r_out_t
);

1043 *
__tmp
 = 
NULL
;

1045 
oÿÎoc_size
 +ğ(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) ? _len_val : 0;

1047 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1048 ià(
__tmp
 =ğ
NULL
) {

1049 
	`sgx_ocä“
();

1050  
SGX_ERROR_UNEXPECTED
;

1052 
ms
 = (
ms_oÿÎ_poš‹r_out_t
*)
__tmp
;

1053 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_poš‹r_out_t
));

1055 ià(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) {

1056 
ms
->
ms_v®
 = (*)
__tmp
;

1057 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_v®
);

1058 
	`mem£t
(
ms
->
ms_v®
, 0, 
_Ën_v®
);

1059 } ià(
v®
 =ğ
NULL
) {

1060 
ms
->
ms_v®
 = 
NULL
;

1062 
	`sgx_ocä“
();

1063  
SGX_ERROR_INVALID_PARAMETER
;

1066 
¡©us
 = 
	`sgx_oÿÎ
(4, 
ms
);

1068 ià(
v®
è
	`memıy
((*)v®, 
ms
->
ms_v®
, 
_Ën_v®
);

1070 
	`sgx_ocä“
();

1071  
¡©us
;

1072 
	}
}

1074 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_poš‹r_š_out
(* 
v®
)

1076 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1077 
size_t
 
_Ën_v®
 = (*
v®
);

1079 
ms_oÿÎ_poš‹r_š_out_t
* 
ms
 = 
NULL
;

1080 
size_t
 
oÿÎoc_size
 = (
ms_oÿÎ_poš‹r_š_out_t
);

1081 *
__tmp
 = 
NULL
;

1083 
oÿÎoc_size
 +ğ(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) ? _len_val : 0;

1085 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1086 ià(
__tmp
 =ğ
NULL
) {

1087 
	`sgx_ocä“
();

1088  
SGX_ERROR_UNEXPECTED
;

1090 
ms
 = (
ms_oÿÎ_poš‹r_š_out_t
*)
__tmp
;

1091 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_oÿÎ_poš‹r_š_out_t
));

1093 ià(
v®
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(v®, 
_Ën_v®
)) {

1094 
ms
->
ms_v®
 = (*)
__tmp
;

1095 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_v®
);

1096 
	`memıy
(
ms
->
ms_v®
, 
v®
, 
_Ën_v®
);

1097 } ià(
v®
 =ğ
NULL
) {

1098 
ms
->
ms_v®
 = 
NULL
;

1100 
	`sgx_ocä“
();

1101  
SGX_ERROR_INVALID_PARAMETER
;

1104 
¡©us
 = 
	`sgx_oÿÎ
(5, 
ms
);

1106 ià(
v®
è
	`memıy
((*)v®, 
ms
->
ms_v®
, 
_Ën_v®
);

1108 
	`sgx_ocä“
();

1109  
¡©us
;

1110 
	}
}

1112 
sgx_¡©us_t
 
SGX_CDECL
 
	$memcıy
(** 
»tv®
, * 
de¡
, cÚ¡ * 
¤c
, 
v®
, 
size_t
 
Ën
)

1114 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1115 
size_t
 
_Ën_de¡
 = 
Ën
;

1116 
size_t
 
_Ën_¤c
 = 
Ën
;

1118 
ms_memcıy_t
* 
ms
 = 
NULL
;

1119 
size_t
 
oÿÎoc_size
 = (
ms_memcıy_t
);

1120 *
__tmp
 = 
NULL
;

1122 
oÿÎoc_size
 +ğ(
de¡
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(de¡, 
_Ën_de¡
)) ? _len_dest : 0;

1123 
oÿÎoc_size
 +ğ(
¤c
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(¤c, 
_Ën_¤c
)) ? _len_src : 0;

1125 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1126 ià(
__tmp
 =ğ
NULL
) {

1127 
	`sgx_ocä“
();

1128  
SGX_ERROR_UNEXPECTED
;

1130 
ms
 = (
ms_memcıy_t
*)
__tmp
;

1131 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_memcıy_t
));

1133 ià(
de¡
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(de¡, 
_Ën_de¡
)) {

1134 
ms
->
ms_de¡
 = (*)
__tmp
;

1135 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_de¡
);

1136 
	`memıy
(
ms
->
ms_de¡
, 
de¡
, 
_Ën_de¡
);

1137 } ià(
de¡
 =ğ
NULL
) {

1138 
ms
->
ms_de¡
 = 
NULL
;

1140 
	`sgx_ocä“
();

1141  
SGX_ERROR_INVALID_PARAMETER
;

1144 ià(
¤c
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(¤c, 
_Ën_¤c
)) {

1145 
ms
->
ms_¤c
 = (*)
__tmp
;

1146 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_¤c
);

1147 
	`memıy
((*)
ms
->
ms_¤c
, 
¤c
, 
_Ën_¤c
);

1148 } ià(
¤c
 =ğ
NULL
) {

1149 
ms
->
ms_¤c
 = 
NULL
;

1151 
	`sgx_ocä“
();

1152  
SGX_ERROR_INVALID_PARAMETER
;

1155 
ms
->
ms_v®
 = 
v®
;

1156 
ms
->
ms_Ën
 = 
Ën
;

1157 
¡©us
 = 
	`sgx_oÿÎ
(6, 
ms
);

1159 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

1160 ià(
de¡
è
	`memıy
((*)de¡, 
ms
->
ms_de¡
, 
_Ën_de¡
);

1162 
	`sgx_ocä“
();

1163  
¡©us
;

1164 
	}
}

1166 
sgx_¡©us_t
 
SGX_CDECL
 
	$oÿÎ_funùiÚ_®low
()

1168 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1169 
¡©us
 = 
	`sgx_oÿÎ
(7, 
NULL
);

1171  
¡©us
;

1172 
	}
}

1174 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_oc_ıuidex
(
ıušfo
[4], 
Ëaf
, 
subËaf
)

1176 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1177 
size_t
 
_Ën_ıušfo
 = 4 * (*
ıušfo
);

1179 
ms_sgx_oc_ıuidex_t
* 
ms
 = 
NULL
;

1180 
size_t
 
oÿÎoc_size
 = (
ms_sgx_oc_ıuidex_t
);

1181 *
__tmp
 = 
NULL
;

1183 
oÿÎoc_size
 +ğ(
ıušfo
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(ıušfo, 
_Ën_ıušfo
)) ? _len_cpuinfo : 0;

1185 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1186 ià(
__tmp
 =ğ
NULL
) {

1187 
	`sgx_ocä“
();

1188  
SGX_ERROR_UNEXPECTED
;

1190 
ms
 = (
ms_sgx_oc_ıuidex_t
*)
__tmp
;

1191 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_sgx_oc_ıuidex_t
));

1193 ià(
ıušfo
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(ıušfo, 
_Ën_ıušfo
)) {

1194 
ms
->
ms_ıušfo
 = (*)
__tmp
;

1195 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_ıušfo
);

1196 
	`memıy
(
ms
->
ms_ıušfo
, 
ıušfo
, 
_Ën_ıušfo
);

1197 } ià(
ıušfo
 =ğ
NULL
) {

1198 
ms
->
ms_ıušfo
 = 
NULL
;

1200 
	`sgx_ocä“
();

1201  
SGX_ERROR_INVALID_PARAMETER
;

1204 
ms
->
ms_Ëaf
 = 
Ëaf
;

1205 
ms
->
ms_subËaf
 = 
subËaf
;

1206 
¡©us
 = 
	`sgx_oÿÎ
(8, 
ms
);

1208 ià(
ıušfo
è
	`memıy
((*)ıušfo, 
ms
->
ms_ıušfo
, 
_Ën_ıušfo
);

1210 
	`sgx_ocä“
();

1211  
¡©us
;

1212 
	}
}

1214 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
(* 
»tv®
, cÚ¡ * 
£lf
)

1216 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1218 
ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
* 
ms
 = 
NULL
;

1219 
size_t
 
oÿÎoc_size
 = (
ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
);

1220 *
__tmp
 = 
NULL
;

1223 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1224 ià(
__tmp
 =ğ
NULL
) {

1225 
	`sgx_ocä“
();

1226  
SGX_ERROR_UNEXPECTED
;

1228 
ms
 = (
ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
*)
__tmp
;

1229 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ_t
));

1231 
ms
->
ms_£lf
 = 
	`SGX_CAST
(*, 
£lf
);

1232 
¡©us
 = 
	`sgx_oÿÎ
(9, 
ms
);

1234 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

1236 
	`sgx_ocä“
();

1237  
¡©us
;

1238 
	}
}

1240 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
(* 
»tv®
, cÚ¡ * 
wa™”
)

1242 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1244 
ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
* 
ms
 = 
NULL
;

1245 
size_t
 
oÿÎoc_size
 = (
ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
);

1246 *
__tmp
 = 
NULL
;

1249 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1250 ià(
__tmp
 =ğ
NULL
) {

1251 
	`sgx_ocä“
();

1252  
SGX_ERROR_UNEXPECTED
;

1254 
ms
 = (
ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
*)
__tmp
;

1255 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ_t
));

1257 
ms
->
ms_wa™”
 = 
	`SGX_CAST
(*, 
wa™”
);

1258 
¡©us
 = 
	`sgx_oÿÎ
(10, 
ms
);

1260 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

1262 
	`sgx_ocä“
();

1263  
¡©us
;

1264 
	}
}

1266 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
(* 
»tv®
, cÚ¡ * 
wa™”
, cÚ¡ * 
£lf
)

1268 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1270 
ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
* 
ms
 = 
NULL
;

1271 
size_t
 
oÿÎoc_size
 = (
ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
);

1272 *
__tmp
 = 
NULL
;

1275 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1276 ià(
__tmp
 =ğ
NULL
) {

1277 
	`sgx_ocä“
();

1278  
SGX_ERROR_UNEXPECTED
;

1280 
ms
 = (
ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
*)
__tmp
;

1281 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ_t
));

1283 
ms
->
ms_wa™”
 = 
	`SGX_CAST
(*, 
wa™”
);

1284 
ms
->
ms_£lf
 = 
	`SGX_CAST
(*, 
£lf
);

1285 
¡©us
 = 
	`sgx_oÿÎ
(11, 
ms
);

1287 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

1289 
	`sgx_ocä“
();

1290  
¡©us
;

1291 
	}
}

1293 
sgx_¡©us_t
 
SGX_CDECL
 
	$sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
(* 
»tv®
, cÚ¡ ** 
wa™”s
, 
size_t
 
tÙ®
)

1295 
sgx_¡©us_t
 
¡©us
 = 
SGX_SUCCESS
;

1296 
size_t
 
_Ën_wa™”s
 = 
tÙ®
 * (*
wa™”s
);

1298 
ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
* 
ms
 = 
NULL
;

1299 
size_t
 
oÿÎoc_size
 = (
ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
);

1300 *
__tmp
 = 
NULL
;

1302 
oÿÎoc_size
 +ğ(
wa™”s
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(wa™”s, 
_Ën_wa™”s
)) ? _len_waiters : 0;

1304 
__tmp
 = 
	`sgx_oÿÎoc
(
oÿÎoc_size
);

1305 ià(
__tmp
 =ğ
NULL
) {

1306 
	`sgx_ocä“
();

1307  
SGX_ERROR_UNEXPECTED
;

1309 
ms
 = (
ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
*)
__tmp
;

1310 
__tmp
 = (*)((
size_t
)__tm°+ (
ms_sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ_t
));

1312 ià(
wa™”s
 !ğ
NULL
 && 
	`sgx_is_w™hš_’şave
(wa™”s, 
_Ën_wa™”s
)) {

1313 
ms
->
ms_wa™”s
 = (**)
__tmp
;

1314 
__tmp
 = (*)((
size_t
)__tm°+ 
_Ën_wa™”s
);

1315 
	`memıy
((*)
ms
->
ms_wa™”s
, 
wa™”s
, 
_Ën_wa™”s
);

1316 } ià(
wa™”s
 =ğ
NULL
) {

1317 
ms
->
ms_wa™”s
 = 
NULL
;

1319 
	`sgx_ocä“
();

1320  
SGX_ERROR_INVALID_PARAMETER
;

1323 
ms
->
ms_tÙ®
 = 
tÙ®
;

1324 
¡©us
 = 
	`sgx_oÿÎ
(12, 
ms
);

1326 ià(
»tv®
è*»tv® = 
ms
->
ms_»tv®
;

1328 
	`sgx_ocä“
();

1329  
¡©us
;

1330 
	}
}

1332 #ifdeà
_MSC_VER


1333 #´agm¨
w¬nšg
(
pİ
)

	@Enclave/Enclave_t.h

1 #iâdeà
ENCLAVE_T_H__


2 
	#ENCLAVE_T_H__


	)

4 
	~<¡dšt.h
>

5 
	~<wch¬.h
>

6 
	~<¡ddef.h
>

7 
	~"sgx_edg”8r.h
"

9 
	~"u£r_ty³s.h
"

11 
	#SGX_CAST
(
ty³
, 
™em
è(Ñy³)(™em))

	)

13 #ifdeà
__ılu¥lus


17 
	s¡ruù_foo_t
 {

18 
ušt32_t
 
¡ruù_foo_0
;

19 
ušt64_t
 
¡ruù_foo_1
;

20 } 
	t¡ruù_foo_t
;

22 
	e’um_foo_t
 {

23 
ENUM_FOO_0
 = 0,

24 
ENUM_FOO_1
 = 1,

25 } 
	t’um_foo_t
;

27 
	uuniÚ_foo_t
 {

28 
ušt32_t
 
uniÚ_foo_0
;

29 
ušt32_t
 
uniÚ_foo_1
;

30 
ušt64_t
 
uniÚ_foo_3
;

31 } 
	tuniÚ_foo_t
;

33 
size_t
 
g‘_bufãr_Ën
(cÚ¡ * 
v®
);

35 
eÿÎ_maš
();

36 
eÿÎ_ty³_ch¬
(
v®
);

37 
eÿÎ_ty³_št
(
v®
);

38 
eÿÎ_ty³_æßt
(
v®
);

39 
eÿÎ_ty³_doubË
(
v®
);

40 
eÿÎ_ty³_size_t
(
size_t
 
v®
);

41 
eÿÎ_ty³_wch¬_t
(
wch¬_t
 
v®
);

42 
eÿÎ_ty³_¡ruù
(
¡ruù_foo_t
 
v®
);

43 
eÿÎ_ty³_’um_uniÚ
(
’um_foo_t
 
v®1
, 
uniÚ_foo_t
* 
v®2
);

44 
size_t
 
eÿÎ_poš‹r_u£r_check
(* 
v®
, size_ˆ
sz
);

45 
eÿÎ_poš‹r_š
(* 
v®
);

46 
eÿÎ_poš‹r_out
(* 
v®
);

47 
eÿÎ_poš‹r_š_out
(* 
v®
);

48 
eÿÎ_poš‹r_¡ršg
(* 
¡r
);

49 
eÿÎ_poš‹r_¡ršg_cÚ¡
(cÚ¡ * 
¡r
);

50 
eÿÎ_poš‹r_size
(* 
±r
, 
size_t
 
Ën
);

51 
eÿÎ_poš‹r_couÁ
(* 
¬r
, 
út
);

52 
eÿÎ_poš‹r_i¥Œ_»adÚly
(
bufãr_t
 
buf
, 
size_t
 
Ën
);

53 
eÿÎ_poš‹r_sizefunc
(* 
buf
);

54 
oÿÎ_poš‹r_©Œ
();

55 
eÿÎ_¬¿y_u£r_check
(
¬r
[4]);

56 
eÿÎ_¬¿y_š
(
¬r
[4]);

57 
eÿÎ_¬¿y_out
(
¬r
[4]);

58 
eÿÎ_¬¿y_š_out
(
¬r
[4]);

59 
eÿÎ_¬¿y_i§ry
(
¬¿y_t
 
¬r
);

60 
eÿÎ_funùiÚ_ÿÎšg_cÚvs
();

61 
eÿÎ_funùiÚ_public
();

62 
eÿÎ_funùiÚ_´iv©e
();

63 
eÿÎ_m®loc_ä“
();

64 
eÿÎ_sgx_ıuid
(
ıušfo
[4], 
Ëaf
);

65 
eÿÎ_exû±iÚ
();

66 
eÿÎ_m­
();

67 
size_t
 
eÿÎ_šü—£_couÁ”
();

68 
eÿÎ_´oduûr
();

69 
eÿÎ_cÚsum”
();

71 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_´št_¡ršg
(cÚ¡ * 
¡r
);

72 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_g’”ic
(* 
»tv®
, 
±r
);

73 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_poš‹r_u£r_check
(* 
v®
);

74 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_poš‹r_š
(* 
v®
);

75 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_poš‹r_out
(* 
v®
);

76 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_poš‹r_š_out
(* 
v®
);

77 
sgx_¡©us_t
 
SGX_CDECL
 
memcıy
(** 
»tv®
, * 
de¡
, cÚ¡ * 
¤c
, 
v®
, 
size_t
 
Ën
);

78 
sgx_¡©us_t
 
SGX_CDECL
 
oÿÎ_funùiÚ_®low
();

79 
sgx_¡©us_t
 
SGX_CDECL
 
sgx_oc_ıuidex
(
ıušfo
[4], 
Ëaf
, 
subËaf
);

80 
sgx_¡©us_t
 
SGX_CDECL
 
sgx_th»ad_wa™_uÁru¡ed_ev’t_oÿÎ
(* 
»tv®
, cÚ¡ * 
£lf
);

81 
sgx_¡©us_t
 
SGX_CDECL
 
sgx_th»ad_£t_uÁru¡ed_ev’t_oÿÎ
(* 
»tv®
, cÚ¡ * 
wa™”
);

82 
sgx_¡©us_t
 
SGX_CDECL
 
sgx_th»ad_£twa™_uÁru¡ed_ev’ts_oÿÎ
(* 
»tv®
, cÚ¡ * 
wa™”
, cÚ¡ * 
£lf
);

83 
sgx_¡©us_t
 
SGX_CDECL
 
sgx_th»ad_£t_muÉË_uÁru¡ed_ev’ts_oÿÎ
(* 
»tv®
, cÚ¡ ** 
wa™”s
, 
size_t
 
tÙ®
);

85 #ifdeà
__ılu¥lus


	@Enclave/TrustedLibrary/Libc.cpp

26 
	~<¡ršg.h
>

27 
	~<sgx_ıuid.h
>

29 
	~"sgx_Œts.h
"

30 
	~"../Enşave.h
"

31 
	~"Enşave_t.h
"

36 
	$eÿÎ_m®loc_ä“
()

38 *
±r
 = 
	`m®loc
(100);

39 
	`as£¹
(
±r
 !ğ
NULL
);

40 
	`mem£t
(
±r
, 0x0, 100);

41 
	`ä“
(
±r
);

42 
	}
}

47 
	$eÿÎ_sgx_ıuid
(
ıušfo
[4], 
Ëaf
)

49 
sgx_¡©us_t
 
»t
 = 
	`sgx_ıuid
(
ıušfo
, 
Ëaf
);

50 ià(
»t
 !ğ
SGX_SUCCESS
)

51 
	`abÜt
();

52 
	}
}

	@Enclave/TrustedLibrary/Libcxx.cpp

26 
	~<c¡dlib
>

27 
	~<¡ršg
>

29 
	~"../Enşave.h
"

30 
	~"Enşave_t.h
"

37 
	$eÿÎ_exû±iÚ
()

39 
¡d
::
¡ršg
 
foo
 = "foo";

40 
Œy
 {

41 
throw
 
¡d
::
	`ruÁime_”rÜ
(
foo
);

43 
	`ÿtch
 (
¡d
::
ruÁime_”rÜ
 cÚ¡& 
e
) {

44 
	`as£¹
Ğ
foo
 =ğ
e
.
	`wh©
() );

45 
¡d
::
ruÁime_”rÜ
 
	`şÚe
("");

46 
şÚe
 = 
e
;

47 
	`as£¹
(
foo
 =ğ
şÚe
.
	`wh©
() );

49 
	`ÿtch
 (...) {

50 
	`as£¹
Ğ
çl£
 );

52 
	}
}

54 
	~<m­
>

55 
	~<®gÜ™hm
>

57 
usšg
 
Çme¥aû
 
	g¡d
;

63 
	$eÿÎ_m­
()

65 
m­
<, , 
	tËss
<> > 
	tm­_t
;

66 
m­_t
::
	tv®ue_ty³
 
	tm­_v®ue
;

67 
m­_t
 
m
;

69 
m
.
	`š£¹
(
	`m­_v®ue
('a', 1));

70 
m
.
	`š£¹
(
	`m­_v®ue
('b', 2));

71 
m
.
	`š£¹
(
	`m­_v®ue
('c', 3));

72 
m
.
	`š£¹
(
	`m­_v®ue
('d', 4));

74 
	`as£¹
(
m
['a'] == 1);

75 
	`as£¹
(
m
['b'] == 2);

76 
	`as£¹
(
m
['c'] == 3);

77 
	`as£¹
(
m
['d'] == 4);

79 
	`as£¹
(
m
.
	`fšd
('e'è=ğm.
	`’d
());

82 
	}
}

	@Enclave/TrustedLibrary/Thread.cpp

26 
	~"../Enşave.h
"

27 
	~"Enşave_t.h
"

29 
	~<sgx_th»ad.h
>

31 
size_t
 
	gglob®_couÁ”
 = 0;

32 
sgx_th»ad_mu‹x_t
 
	gglob®_mu‹x
 = 
SGX_THREAD_MUTEX_INITIALIZER
;

34 
	#BUFFER_SIZE
 50

	)

37 
	mbuf
[
BUFFER_SIZE
];

38 
	moccup›d
;

39 
	mÃxtš
;

40 
	mÃxtout
;

41 
sgx_th»ad_mu‹x_t
 
	mmu‹x
;

42 
sgx_th»ad_cÚd_t
 
	mmÜe
;

43 
sgx_th»ad_cÚd_t
 
	mËss
;

44 } 
	tcÚd_bufãr_t
;

46 
cÚd_bufãr_t
 
	gbufãr
 = {{0, 0, 0, 0, 0, 0}, 0, 0, 0,

47 
SGX_THREAD_MUTEX_INITIALIZER
, 
SGX_THREAD_COND_INITIALIZER
, SGX_THREAD_COND_INITIALIZER};

53 
size_t
 
	$eÿÎ_šü—£_couÁ”
()

55 
size_t
 
»t
 = 0;

56 
i
 = 0; i < 
LOOPS_PER_THREAD
; i++) {

57 
	`sgx_th»ad_mu‹x_lock
(&
glob®_mu‹x
);

59 
size_t
 
tmp
 = 
glob®_couÁ”
;

60 
glob®_couÁ”
 = ++
tmp
;

61 ià(4*
LOOPS_PER_THREAD
 =ğ
glob®_couÁ”
)

62 
»t
 = 
glob®_couÁ”
;

63 
	`sgx_th»ad_mu‹x_uÆock
(&
glob®_mu‹x
);

65  
»t
;

66 
	}
}

68 
	$eÿÎ_´oduûr
()

70 
i
 = 0; i < 4*
LOOPS_PER_THREAD
; i++) {

71 
cÚd_bufãr_t
 *
b
 = &
bufãr
;

72 
	`sgx_th»ad_mu‹x_lock
(&
b
->
mu‹x
);

73 
b
->
occup›d
 >ğ
BUFFER_SIZE
)

74 
	`sgx_th»ad_cÚd_wa™
(&
b
->
Ëss
, &b->
mu‹x
);

75 
b
->
buf
[b->
Ãxtš
] = b->nextin;

76 
b
->
Ãxtš
++;

77 
b
->
Ãxtš
 %ğ
BUFFER_SIZE
;

78 
b
->
occup›d
++;

79 
	`sgx_th»ad_cÚd_sigÇl
(&
b
->
mÜe
);

80 
	`sgx_th»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

82 
	}
}

84 
	$eÿÎ_cÚsum”
()

86 
i
 = 0; i < 
LOOPS_PER_THREAD
; i++) {

87 
cÚd_bufãr_t
 *
b
 = &
bufãr
;

88 
	`sgx_th»ad_mu‹x_lock
(&
b
->
mu‹x
);

89 
b
->
occup›d
 <= 0)

90 
	`sgx_th»ad_cÚd_wa™
(&
b
->
mÜe
, &b->
mu‹x
);

91 
b
->
buf
[b->
Ãxtout
++] = 0;

92 
b
->
Ãxtout
 %ğ
BUFFER_SIZE
;

93 
b
->
occup›d
--;

94 
	`sgx_th»ad_cÚd_sigÇl
(&
b
->
Ëss
);

95 
	`sgx_th»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

97 
	}
}

	@Enclave/main.c

1 
my´štf
(const *, ...);

2 
	$maš
(){

4 
	`my´štf
("Hello world\n");

6 
	}
}

	@Include/user_types.h

28 #ifdeà
_MSC_VER


29 
	#memcıy
 
_memcıy


	)

32 
	#LOOPS_PER_THREAD
 500

	)

34 *
	tbufãr_t
;

35 
	t¬¿y_t
[10];

	@
1
.
0
24
612
App/App.cpp
App/App.h
App/Edger8rSyntax/Arrays.cpp
App/Edger8rSyntax/Functions.cpp
App/Edger8rSyntax/Pointers.cpp
App/Edger8rSyntax/Types.cpp
App/Enclave_u.c
App/Enclave_u.h
App/TrustedLibrary/Libc.cpp
App/TrustedLibrary/Libcxx.cpp
App/TrustedLibrary/Thread.cpp
Enclave/Edger8rSyntax/Arrays.cpp
Enclave/Edger8rSyntax/Functions.cpp
Enclave/Edger8rSyntax/Pointers.cpp
Enclave/Edger8rSyntax/Types.cpp
Enclave/Enclave.cpp
Enclave/Enclave.h
Enclave/Enclave_t.c
Enclave/Enclave_t.h
Enclave/TrustedLibrary/Libc.cpp
Enclave/TrustedLibrary/Libcxx.cpp
Enclave/TrustedLibrary/Thread.cpp
Enclave/main.c
Include/user_types.h
